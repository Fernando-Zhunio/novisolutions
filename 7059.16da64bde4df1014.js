"use strict";(self.webpackChunkng=self.webpackChunkng||[]).push([[7059],{24576:(B,P,m)=>{m.d(P,{G:()=>t,c:()=>C});var r=m(56498);function C(Z){let g,b,N;const x=[void 0,null,!1,0,"","0"];for(b=0,N=x.length;b<N;b++)if(Z===x[b])return!0;if("object"==typeof Z){for(g in Z)if(Z.hasOwnProperty(g))return!1;return!0}return!1}let y=null;function t(Z){(function O(Z){return r.y.create(v=>{const g=new Image;g.crossOrigin="Anonymous",g.src=Z,g.complete?(v.next(_(g)),v.complete()):(g.onload=()=>{v.next(_(g)),v.complete()},g.onerror=b=>{v.error(b)})})})(Z).subscribe(v=>{console.log(v),y="data:image/jpg;base64,"+v;var g=document.createElement("a");document.body.appendChild(g),g.setAttribute("href",y),g.setAttribute("download","file_novisolutions.jpg"),g.click()})}function _(Z){const v=document.createElement("canvas");return v.width=Z.width,v.height=Z.height,v.getContext("2d").drawImage(Z,0,0),v.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"")}},72349:(B,P,m)=>{m.d(P,{H:()=>Y});var r=m(5e3),C=m(24576),y=m(29724),t=m(59516),O=m(95625),_=m(69808),Z=m(25245),v=m(93075),g=m(47423),b=m(92181),N=m(26688),x=m(27544);function S(T,p){if(1&T){const u=r.EpF();r.ynx(0),r.TgZ(1,"mat-chip-list",13)(2,"mat-chip",14)(3,"mat-icon",11),r._uU(4,"filter_alt"),r.qZA(),r._uU(5," filtros "),r.qZA()(),r.TgZ(6,"mat-menu",15,16),r.Hsn(8,2),r.TgZ(9,"div",17)(10,"button",18),r.NdJ("click",function(){r.CHM(u);const h=r.oxw();return r.KtG(h.searchBarReset())}),r._uU(11,"Aplicar filtros"),r.qZA()()(),r.BQk()}if(2&T){const u=r.MAs(7),d=r.oxw();r.xp6(2),r.Q6J("matBadge",d.countFilter||null)("matMenuTriggerFor",u),r.xp6(4),r.Q6J("overlapTrigger",!1),r.xp6(3),r.Q6J("disableRipple",!0)}}const D=["*",[["",8,"selections-back"]],[["","filterMenu",""]]],G=function(T){return{"sticky-top":T}},M=["*",".selections-back","[filterMenu]"];let Y=(()=>{class T{constructor(u,d,h,k){this.router=u,this.activeRoute=d,this.methodsHttp=h,this._location=k,this.isLoading=new r.vpe(!1),this.products=new r.vpe,this.url="",this.placeholder="Escriba el nombre del producto",this.filter_data={},this.active_filters_menu=!1,this.isSticky=!0,this.init=!0,this.spinner_name=null,this.canModifyBarSearch=!0,this.title="Pagina Novisolutions",this.pageEvent={length:0,pageIndex:0,pageSize:15},this.productSearch="",this.countFilter=0}ngOnInit(){if(this.init){const u=this.getQueryParams();u?this.searchBar(u):this.searchBar()}}getQueryParams(){const u=JSON.parse(JSON.stringify(this.activeRoute.snapshot.queryParamMap.params));try{u.hasOwnProperty("search")&&(this.productSearch=u.search),u.hasOwnProperty("pageSize")&&(this.pageEvent.pageSize=u.pageSize),u.hasOwnProperty("page")&&(this.pageEvent.pageIndex=parseInt(u.page,10)-1)}catch(d){}return this.pageEvent}buscarInterval(u){clearTimeout(this.intervalSearch),13!==u.keyCode?this.intervalSearch=setTimeout(()=>{this.searchBarReset()},1e3):this.searchBarReset()}searchBar(u=null){this.isLoading.emit(!0),this.subscription&&this.subscription.unsubscribe();const d=u||this.pageEvent;this.pageEvent=d,window.scrollTo(0,0),this.subscription=this.methodsHttp.methodGet(this.url,Object.assign({pageSize:d.pageSize,search:this.productSearch,page:d.pageIndex+1},this.filterWithNotNull())).subscribe(h=>{this.isLoading.emit(!1),this.products.emit(h),this.canModifyBarSearch&&this.router.navigate([],{relativeTo:this.activeRoute,queryParams:{page:d.pageIndex+1,pageSize:d.pageSize,search:this.productSearch},replaceUrl:!0})},()=>{this.isLoading.emit(!1)})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}filterWithNotNull(){this.countFilter=0;const u={};return Object.keys(this.filter_data).forEach(d=>{var h;if(!(0,C.c)(this.filter_data[d])||"0"===this.filter_data[d]){if((null===(h=this.filter_data[d])||void 0===h?void 0:h.length)<1)return;u[d]=this.filter_data[d],this.countFilter++}}),u}paste(){navigator.clipboard?navigator.clipboard.readText().then(u=>{this.productSearch=u}):y.J.swalToast("Necesitas proporcionar permisos de portapapeles a esta pagina","warning")}searchBarReset(){this.pageEvent={length:0,pageIndex:0,pageSize:this.pageEvent.pageSize},this.searchBar(this.pageEvent)}refrescated(){const u=localStorage.getItem("data_refresh");if(u){const d=JSON.parse(u);d.now&&this.activeRoute.paramMap.name===d.name&&this.searchBar()}}goBack(){this._location.back()}}return T.\u0275fac=function(u){return new(u||T)(r.Y36(t.F0),r.Y36(t.gz),r.Y36(O.s),r.Y36(_.Ye))},T.\u0275cmp=r.Xpm({type:T,selectors:[["app-header-search"]],inputs:{url:"url",placeholder:"placeholder",filter_data:"filter_data",active_filters_menu:"active_filters_menu",isSticky:"isSticky",init:"init",spinner_name:"spinner_name",canModifyBarSearch:"canModifyBarSearch",title:"title"},outputs:{isLoading:"isLoading",products:"products"},ngContentSelectors:M,decls:20,vars:7,consts:[[1,"m-0","mb-2","d-md-flex","flex-wrap","align-items-center","justify-content-between","py-1","px-0","px-md-3","main-style",2,"z-index","2","top","55px",3,"ngClass"],[1,"center","flex-wrap","overflow-auto"],[1,"m-0","font-weight-bolder","font-4xl"],[1,"position-relative","p-3","overflow-hidden"],[1,"form-control","shadow-sm","input-style",3,"placeholder","ngModel","keyup","ngModelChange"],["mat-icon-button","",1,"btn-go-back",3,"click"],[1,"text-black-50"],["mat-icon-button","",1,"position-absolute","btn-find",3,"click"],["type","search",1,"text-black-50",2,"font-size","30px"],[1,"d-flex","align-items-center",2,"top","0px","right","22px","height","100%"],[1,"text-truncate",3,"click"],["type","search",1,"text-black-50"],[4,"ngIf"],[1,"ml-1"],[1,"text-truncate",3,"matBadge","matMenuTriggerFor"],[1,"menu-style",3,"overlapTrigger"],["menu","matMenu"],["mat-menu-item","",3,"disableRipple"],["color","warning","mat-raised-button","",3,"click"]],template:function(u,d){1&u&&(r.F$t(D),r.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),r._uU(3),r.qZA(),r.TgZ(4,"div",3)(5,"input",4),r.NdJ("keyup",function(k){return d.buscarInterval(k)})("ngModelChange",function(k){return d.productSearch=k}),r.qZA(),r.TgZ(6,"button",5),r.NdJ("click",function(){return d.goBack()}),r.TgZ(7,"mat-icon",6),r._uU(8,"arrow_back"),r.qZA()(),r.TgZ(9,"button",7),r.NdJ("click",function(){return d.searchBarReset()}),r.TgZ(10,"mat-icon",8),r._uU(11,"search"),r.qZA()()()(),r.TgZ(12,"div",9)(13,"mat-chip-list")(14,"mat-chip",10),r.NdJ("click",function(){return d.paste()}),r.TgZ(15,"mat-icon",11),r._uU(16,"content_paste"),r.qZA()()(),r.Hsn(17),r.YNc(18,S,12,4,"ng-container",12),r.qZA(),r.Hsn(19,1),r.qZA()),2&u&&(r.Q6J("ngClass",r.VKq(5,G,d.isSticky)),r.xp6(3),r.Oqu(d.title),r.xp6(2),r.Q6J("placeholder",d.placeholder)("ngModel",d.productSearch),r.xp6(13),r.Q6J("ngIf",d.active_filters_menu))},dependencies:[_.mk,_.O5,Z.Hw,v.Fj,v.JJ,v.On,g.lW,b.VK,b.OP,b.p6,N.qn,N.HS,x.k],styles:[".input-style[_ngcontent-%COMP%]{padding-left:84px;height:45px;border-radius:20px;background-color:#f1f3f4;font-weight:600!important;font-size:1rem!important;min-width:350px;max-width:100%}.btn-find[_ngcontent-%COMP%]{top:0px;left:56px;height:100%}.shadow-header[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #787676bf;-webkit-box-shadow:0px 0px 10px 5px rgb(183 180 180 / 75%);-moz-box-shadow:0px 0px 10px 5px rgba(0,0,0,.75)}.btn-go-back[_ngcontent-%COMP%]{position:absolute;top:18.5px;left:19px}@media (max-width:600px){.font-header[_ngcontent-%COMP%]{font-size:1rem!important}.input-style[_ngcontent-%COMP%]{min-width:210px;max-width:100%}}"]}),T})()},7059:(B,P,m)=>{m.r(P),m.d(P,{ImportacionesModule:()=>Me});var r=m(69808),C=m(59516),y=m(41777),t=m(5e3),O=m(72349),_=m(9224),Z=m(84909),v=m(8735),g=m(26688),b=m(25245),N=m(4721),x=m(47423);function S(i,a){if(1&i&&(t.TgZ(0,"button",17)(1,"mat-icon"),t._uU(2,"visibility"),t.qZA()()),2&i){const e=t.oxw();t.Q6J("disabled",e.isLoad)}}function D(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.goEdit())}),t.TgZ(1,"mat-icon"),t._uU(2,"create"),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.isLoad)}}function G(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.destroyImport())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.isLoad)}}function M(i,a){if(1&i&&(t.TgZ(0,"mat-chip"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" LLeg\xf3 el ",t.lcZ(2,1,e.import.arrival_date)," ")}}function Y(i,a){if(1&i&&(t.TgZ(0,"mat-chip"),t._uU(1," FECHA ESTIMADA: "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"date"),t.qZA(),t._uU(5,"\xa0 y\xa0 "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"date"),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.hij("Entre \xa0",t.lcZ(4,2,e.import.estimated_date_first),""),t.xp6(4),t.Oqu(t.lcZ(8,4,e.import.estimated_date_last))}}const T=function(i){return["super-admin",i]};let p=(()=>{class i{constructor(e,o){this.router=e,this.s_standart=o,this.delete=new t.vpe,this.isLoad=!1,this.permissions_component={show:"purchase-department.imports.show",edit:"purchase-department.imports.edit",destroy:"purchase-department.imports.destroy"}}ngOnInit(){}destroyImport(){this.isLoad=!0,this.s_standart.destory(`purchase-department/imports/${this.import.id}`).subscribe(o=>{o.success&&(this.delete.emit(o.data),this.isLoad=!1)},()=>{this.isLoad=!1})}goEdit(){this.router.navigate(["importaciones/edit/"+this.import.id])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(C.F0),t.Y36(v.X))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-import"]],inputs:{import:"import"},outputs:{delete:"delete"},decls:62,vars:22,consts:[[1,"header","position-relative",2,"padding-bottom","5px","text-transform","uppercase"],[1,"position-absolute",2,"top","-37px","right","0"],["color","accent","mat-mini-fab","",3,"disabled",4,"ngxPermissionsOnly"],["color","primary","mat-mini-fab","",3,"disabled","click",4,"ngxPermissionsOnly"],["color","warn","mat-mini-fab","",3,"disabled","click",4,"ngxPermissionsOnly"],["aria-label","Fish selection"],[4,"ngIf","ngIfElse"],["dateBetween",""],[1,"row","card-body","align-items-center"],[1,"col-md-4","px-2"],[1,"d-flex","justify-content-around","bg-vimeo"],[1,"fas","fa-tag","font-5xl","mx-3","d-flex","align-items-center"],[1,"d-flex","bg-dark","justify-content-around"],[1,"far","fa-clipboard","mx-3","font-5xl","d-flex","align-items-center"],[1,"font-3xl"],[1,"d-flex","justify-content-around","bg-yellow"],[1,"fas","fa-briefcase","mx-3","font-5xl","d-flex","align-items-center"],["color","accent","mat-mini-fab","",3,"disabled"],["color","primary","mat-mini-fab","",3,"disabled","click"],["color","warn","mat-mini-fab","",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-card-content",0)(1,"div",1),t.YNc(2,S,3,1,"button",2),t.YNc(3,D,3,1,"button",3),t.YNc(4,G,3,1,"button",4),t.qZA(),t.TgZ(5,"div")(6,"mat-card-title"),t._uU(7),t.qZA(),t.TgZ(8,"mat-card-subtitle"),t._uU(9," C\xf3digo: "),t.TgZ(10,"b"),t._uU(11),t.qZA()()(),t.TgZ(12,"div")(13,"mat-chip-list",5)(14,"mat-chip"),t._uU(15),t.qZA(),t.TgZ(16,"mat-chip"),t._uU(17,"Productos: "),t.TgZ(18,"b"),t._uU(19),t.qZA()(),t.TgZ(20,"mat-chip"),t._uU(21,"Promociones: "),t.TgZ(22,"b"),t._uU(23),t.qZA()(),t.YNc(24,M,3,3,"mat-chip",6),t.YNc(25,Y,9,6,"ng-template",null,7,t.W1O),t.qZA()(),t.TgZ(27,"div")(28,"div",8)(29,"div",9)(30,"mat-card",10),t._UZ(31,"i",11),t.TgZ(32,"div")(33,"div"),t._uU(34,"Productos: "),t.TgZ(35,"b"),t._uU(36),t.qZA()(),t.TgZ(37,"div"),t._uU(38,"Nuevos: "),t.TgZ(39,"b"),t._uU(40),t.qZA()(),t.TgZ(41,"div"),t._uU(42,"Repuestos: "),t.TgZ(43,"b"),t._uU(44),t.qZA()()()()(),t.TgZ(45,"div",9)(46,"mat-card",12),t._UZ(47,"i",13),t.TgZ(48,"div")(49,"div"),t._uU(50,"Facturas"),t.qZA(),t.TgZ(51,"div",14),t._uU(52),t.qZA()()()(),t.TgZ(53,"div",9)(54,"mat-card",15),t._UZ(55,"i",16),t.TgZ(56,"div")(57,"div"),t._uU(58,"Proveedores"),t.qZA(),t.TgZ(59,"div")(60,"b"),t._uU(61),t.qZA()()()()()()()()),2&e){const n=t.MAs(26);t.xp6(2),t.Q6J("ngxPermissionsOnly",t.VKq(16,T,o.permissions_component.show)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.VKq(18,T,o.permissions_component.edit)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.VKq(20,T,o.permissions_component.destroy)),t.xp6(3),t.AsE("Importaci\xf3n ",o.import.sequence.origin.name," #",o.import.sequence.sequence_number," "),t.xp6(4),t.Oqu(o.import.code),t.xp6(4),t.Oqu(null==o.import.last_status||null==o.import.last_status.status?null:o.import.last_status.status.name),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.product_import_count),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.promotion_count),t.xp6(1),t.Q6J("ngIf",o.import.arrival_date)("ngIfElse",n),t.xp6(12),t.Oqu(null==o.import.Counts?null:o.import.Counts.product_count),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.product_new_count),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.product_respuesto_count),t.xp6(8),t.hij(" ",null==o.import.invoices?null:o.import.invoices.length," "),t.xp6(9),t.hij(" ",null==o.import.Counts?null:o.import.Counts.proveedores," ")}},dependencies:[r.O5,_.a8,_.dn,_.n5,_.$j,g.qn,g.HS,b.Hw,N.gE,x.lW,r.uU]}),i})();const u=function(){return{"border-radius":"5px",height:"50px"}},d=function(){return{"border-radius":"5px",height:"30px"}},h=function(){return{"border-radius":"5px",height:"40px",width:"150px","margin-right":"5px"}};function k(i,a){1&i&&(t.TgZ(0,"mat-card",7),t._UZ(1,"ngx-skeleton-loader",8)(2,"ngx-skeleton-loader",8)(3,"ngx-skeleton-loader",9),t.qZA()),2&i&&(t.xp6(1),t.Q6J("theme",t.DdM(3,u)),t.xp6(1),t.Q6J("theme",t.DdM(4,d)),t.xp6(1),t.Q6J("theme",t.DdM(5,h)))}const $=function(){return[1,2,3]};function z(i,a){1&i&&(t.TgZ(0,"div",5),t.YNc(1,k,4,6,"mat-card",6),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,$)))}function W(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card",7)(1,"app-import",10),t.NdJ("delete",function(n){t.CHM(e);const c=t.oxw(2);return t.KtG(c.destroyImport(n))}),t.qZA()()}if(2&i){const e=a.$implicit;t.Q6J("@fade",void 0),t.xp6(1),t.Q6J("import",e)}}function X(i,a){if(1&i&&(t.TgZ(0,"div",5),t.YNc(1,W,2,2,"mat-card",6),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.imports)}}function dt(i,a){1&i&&(t.TgZ(0,"div",12)(1,"div",13),t._UZ(2,"img",14),t.qZA(),t.TgZ(3,"div",15),t._uU(4," Ups! Sin resultados en tu b\xfasqueda "),t.qZA()())}function lt(i,a){if(1&i&&t.YNc(0,dt,5,0,"div",11),2&i){const e=t.oxw();t.Q6J("ngIf",!e.isload)}}const mt=function(){return["/importaciones/create"]};let pt=(()=>{class i{constructor(){this.imports=[],this.isload=!1}ngOnInit(){}loadData(e){this.imports=e.data.data}destroyImport(e){const o=this.imports.findIndex(n=>n.id==e.id);-1!=o&&this.imports.splice(o,1)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-proveedores"]],decls:9,vars:7,consts:[["mat-fab","",2,"position","fixed","z-index","10","bottom","100px","right","20px",3,"routerLink"],[3,"placeholder","url","isload","products"],["class","mt-4",4,"ngIf"],["class","mt-4",4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"mt-4"],["class","my-4",4,"ngFor","ngForOf"],[1,"my-4"],["count","1",3,"theme"],["count","3",3,"theme"],[3,"import","delete"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-6"],["src","/assets/img/respuesta_vacia.svg","alt","","width","100%"],[1,"col-md-6","font-facebook","font-2xl","d-flex","align-items-center"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div")(1,"button",0)(2,"mat-icon"),t._uU(3,"add"),t.qZA()(),t.TgZ(4,"app-header-search",1),t.NdJ("isload",function(c){return o.isload=c})("products",function(c){return o.loadData(c)}),t.qZA(),t.YNc(5,z,2,2,"div",2),t.YNc(6,X,2,1,"div",3),t.YNc(7,lt,1,1,"ng-template",null,4,t.W1O),t.qZA()),2&e){const n=t.MAs(8);t.xp6(1),t.Q6J("routerLink",t.DdM(6,mt)),t.xp6(3),t.Q6J("placeholder","Escriba codigo de la importacion")("url","purchase-department/imports"),t.xp6(1),t.Q6J("ngIf",o.isload),t.xp6(1),t.Q6J("ngIf",o.imports.length>0)("ngIfElse",n)}},dependencies:[r.sg,r.O5,C.rH,O.H,_.a8,Z.xr,p,b.Hw,x.lW],data:{animation:[(0,y.X$)("fade",[(0,y.eR)(":leave",[(0,y.oB)({transform:"scale(0)",opacity:"0"}),(0,y.jt)(400)])])]}}),i})();var s=m(93075),I=m(48966),at=m(73018),V=m(29724),j=m(57261),tt=m(86405),A=m(67322),H=m(74107),J=m(90508),L=m(77531),et=m(2638);const ut=["drawer"];function _t(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card",34)(1,"mat-card-header",35)(2,"mat-card-title",36)(3,"div",37)(4,"span",38),t._uU(5),t.qZA(),t._uU(6),t.qZA()()(),t.TgZ(7,"mat-card-content")(8,"div",14)(9,"div",39)(10,"div")(11,"small",40),t._uU(12," Tipo: "),t.TgZ(13,"b"),t._uU(14),t.qZA(),t._uU(15," - C\xf3digo: "),t.TgZ(16,"b"),t._uU(17),t.qZA(),t._uU(18," - C\xf3digo Alternativo: "),t.TgZ(19,"b"),t._uU(20),t.qZA(),t._uU(21," - Categoria: "),t.TgZ(22,"b"),t._uU(23),t.qZA(),t._uU(24," - Marca: "),t.TgZ(25,"b"),t._uU(26),t.qZA(),t._uU(27," - Secuencia: "),t.TgZ(28,"b"),t._uU(29),t.qZA(),t._UZ(30,"br"),t.qZA(),t.TgZ(31,"button",41),t.NdJ("click",function(){const c=t.CHM(e).index,l=t.oxw();return t.KtG(l.selectProductRelationship(c))}),t._uU(32,"Seleccionar"),t.qZA()()(),t.TgZ(33,"div",42),t._UZ(34,"img",43),t.qZA()()()()}if(2&i){const e=a.$implicit,o=a.index,n=t.oxw();t.xp6(5),t.hij("#",e.id,""),t.xp6(1),t.hij("",e.name," "),t.xp6(8),t.Oqu(null==e.prefix?null:e.prefix.type),t.xp6(3),t.Oqu(e.code),t.xp6(3),t.Oqu(e.code_alt),t.xp6(3),t.Oqu(null==e.category?null:e.category.name),t.xp6(3),t.Oqu(null==e.brand?null:e.brand.name),t.xp6(3),t.Oqu(null==e.sequence?null:e.sequence.sequence_number),t.xp6(5),t.Q6J("src",n.captureImagenProduct(o),t.LSH)}}function ft(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card")(1,"mat-card-header",35)(2,"mat-card-title",36)(3,"div",37)(4,"span",38),t._uU(5),t.qZA(),t._uU(6),t.qZA()()(),t.TgZ(7,"mat-card-content")(8,"div",14)(9,"div",39)(10,"div")(11,"small",40),t._uU(12," Tipo: "),t.TgZ(13,"b"),t._uU(14),t.qZA(),t._uU(15," - C\xf3digo: "),t.TgZ(16,"b"),t._uU(17),t.qZA(),t._uU(18," - C\xf3digo Alternativo: "),t.TgZ(19,"b"),t._uU(20),t.qZA(),t._uU(21," - Categoria: "),t.TgZ(22,"b"),t._uU(23),t.qZA(),t._uU(24," - Marca: "),t.TgZ(25,"b"),t._uU(26),t.qZA(),t._uU(27," - Secuencia: "),t.TgZ(28,"b"),t._uU(29),t.qZA(),t._UZ(30,"br"),t.qZA(),t.TgZ(31,"button",44),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.removeProductRelationship())}),t._uU(32,"Quitar producto"),t.qZA()()(),t.TgZ(33,"div",42),t._UZ(34,"img",45),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(5),t.hij("#",e.product_relationship.id,""),t.xp6(1),t.hij("",e.product_relationship.name," "),t.xp6(8),t.Oqu(null==e.product_relationship.prefix?null:e.product_relationship.prefix.type),t.xp6(3),t.Oqu(e.product_relationship.code),t.xp6(3),t.Oqu(e.product_relationship.code_alt),t.xp6(3),t.Oqu(null==e.product_relationship.category?null:e.product_relationship.category.name),t.xp6(3),t.Oqu(null==e.product_relationship.brand?null:e.product_relationship.brand.name),t.xp6(3),t.Oqu(null==e.product_relationship.sequence?null:e.product_relationship.sequence.sequence_number),t.xp6(5),t.Q6J("src",e.captureImagenProductInique(),t.LSH)}}const gt=function(i){return{"col-md-5":i}};let K=(()=>{class i{constructor(e,o,n,c,l){this.snack=e,this.s_standart=o,this.dialogRef=n,this.spinner=c,this.data=l,this.isLoadItem=!1,this.formMore=new s.cw({new:new s.NI(null,s.kI.required),code:new s.NI(null),description:new s.NI(null,s.kI.required),quantity:new s.NI(null,s.kI.required),price:new s.NI(null,s.kI.required),tariff:new s.NI(""),images:new s.NI([]),note:new s.NI(null),product_id:new s.NI(null)}),this.products=[],this.title="Nuevo item en la factura",this.galleryImages=[],this.state_edit_init="",this.galleryAction={icon:"fas fa-trash text-danger",onClick:(q,w)=>{alert(this.galleryImages[w].medium),this.s_standart.destory("purchase-department/imports/imagen/"+this.galleryImages[w].id).subscribe(nt=>{this.removeImageGallery(nt.data.id)})}},this.imgInvoice="assets/img/img_default_null.jpg"}ngOnInit(){var e,o,n,c,l;if(this.galleryOptions=[{width:"100%",height:"100%",thumbnailsColumns:4,imageAnimation:at.zw.Slide,actions:[this.galleryAction]},{breakpoint:800,width:"100%",height:"100%",imagePercent:80,thumbnailsPercent:20,thumbnailsMargin:20,thumbnailMargin:20},{breakpoint:400,preview:!1}],"edit"===this.data.state&&(this.title="Editando item de la factura"),this.data.hasOwnProperty("formData")){const{code:q,description:w,quantity:F,price:Q,tariff:nt,note:Je,product_id:Le}=this.data.formData;this.formMore.setValue({new:null===(e=this.data.formData)||void 0===e?void 0:e.new,code:q,description:w,quantity:F,price:Q,tariff:nt,images:[],note:Je,product_id:Le}),this.state_edit_init=JSON.stringify(this.formMore.value),this.product_relationship=null===(o=this.data.formData)||void 0===o?void 0:o.product,(null===(c=null===(n=this.data.formData)||void 0===n?void 0:n.images)||void 0===c?void 0:c.length)&&(null===(l=this.data.formData)||void 0===l?void 0:l.images.length)>0&&this.getIdImagens(this.data.formData.images)}}getIdImagens(e){Object.assign(e,[]).forEach(n=>{this.addImageGallery(n.full_url_api,n.id)})}addImageGallery(e,o){this.galleryImages.push({small:e,medium:e,big:e,id:o}),this.formMore.controls.images.value.push(o)}removeImageGallery(e){const o=this.galleryImages.findIndex(n=>n.id===e);if(-1!==o){this.galleryImages.splice(o,1);const n=this.formMore.controls.images.value,c=n.findIndex(e);-1!==c&&n.splice(c,1)}}cancelItemInvoice(){}addItem(){var e;if(this.formMore.valid)if(this.isLoadItem=!0,this.spinner.show(),"create"==this.data.state){let o=this.snack.open("Agregando item espera...");this.s_standart.store("purchase-department/imports/"+this.data.id_import+"/invoices/"+this.data.id_invoice+"/items",this.formMore.value).subscribe(n=>{this.isLoadItem=!1,o.dismiss(),n.success?(this.snack.open("Agregado con \xe9xito","Ok",{duration:2500}),this.dialogRef.close(n)):this.snack.open("Error int\xe9ntalo de nuevo","Error",{duration:2500}),this.spinner.hide()},()=>{o.dismiss(),this.isLoadItem=!1,this.spinner.hide()})}else{const o=JSON.stringify(this.formMore.value),n=this.snack.open("Editando item espera...");if(this.state_edit_init===o)return void V.J.swalToast("No se encuentran cambios","error");this.s_standart.updatePut("purchase-department/imports/"+this.data.id_import+"/invoices/"+this.data.id_invoice+"/items/"+(null===(e=this.data.formData)||void 0===e?void 0:e.id),this.formMore.value).subscribe(c=>{n.dismiss(),c.success?(this.snack.open("Actualizado con exito","Ok",{duration:2500}),this.dialogRef.close(c)):this.snack.open("Error intentalo de nuevo","Error",{duration:2500}),this.isLoadItem=!1,this.spinner.hide()},()=>{n.dismiss(),this.isLoadItem=!1,this.spinner.hide()})}}getProduct(e){this.products=e.data.data}uploadImg(e){let o=e.target.files[0],n=this.snack.open("Actualizando imagen espera...");this.isLoadItem=!0,this.s_standart.uploadImg("purchase-department/imports/"+this.data.id_import+"/upload-item-images",o).subscribe(c=>{n.dismiss(),c.success&&(this.imgInvoice=c.data.full_url_api,this.addImageGallery(this.imgInvoice,c.data.id),this.snack.open("Imagen subida con exito","Ok",{duration:2500})),this.isLoadItem=!1},c=>{n.dismiss(),console.log(c),this.isLoadItem=!1})}captureImagenProduct(e){var o,n,c;return(null===(n=null===(o=this.products[e])||void 0===o?void 0:o.prestashop_products)||void 0===n?void 0:n.length)>0?this.products[e].prestashop_products[0].image:(null===(c=this.products[e].ml_infos)||void 0===c?void 0:c.length)>0?this.products[e].ml_infos[0].image:"assets/img/img_default_null.jpg"}selectProductRelationship(e){this.product_relationship=this.products[e],this.drawer.toggle(),this.formMore.controls.product_id.setValue(this.product_relationship.id)}captureImagenProductInique(){var e,o;return(null===(e=this.product_relationship.prestashop_products)||void 0===e?void 0:e.length)>0?this.product_relationship.prestashop_products[0].image:(null===(o=this.product_relationship.ml_infos)||void 0===o?void 0:o.length)>0?this.product_relationship.ml_infos[0].image:"assets/img/img_default_null.jpg"}removeProductRelationship(){this.product_relationship=null,this.formMore.controls.product_id.setValue(null)}ngOnDestroy(){this.spinner.hide()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(j.ux),t.Y36(v.X),t.Y36(I.so),t.Y36(tt.t2),t.Y36(I.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-invoice-item-modal"]],viewQuery:function(e,o){if(1&e&&t.Gf(ut,5),2&e){let n;t.iGM(n=t.CRH())&&(o.drawer=n.first)}},decls:64,vars:14,consts:[[1,"example-container"],["position","end","mode","push",1,"col-md-8","col-sm-10"],["drawer",""],["mat-dialog-title","",1,"font-2xl","my-2","font-facebook","list-group-item-accent-warning"],[3,"init","url","products"],["class","my-2",4,"ngFor","ngForOf"],[1,"example-sidenav-content"],["mat-dialog-title","",1,"font-5xl","font-facebook","list-group-item-accent-warning"],["type","button","mat-raised-button","","color","accent",3,"click"],[1,"m-0",2,"z-index","1"],["for","imgItem",1,"btn","btn-behance","d-inline-flex"],[1,"mr-2"],["type","file","accept",".png,.jpeg,.jpg","id","imgItem",1,"d-none",3,"change"],[3,"formGroup"],[1,"row","m-0"],[1,"p-2",3,"ngClass"],[1,"col-md-4"],["matInput","","formControlName","code"],["matInput","","type","number","formControlName","quantity"],["matInput","","type","number","formControlName","price"],[1,"col-md-6"],["formControlName","new"],["value","true"],["value","false"],["matInput","","type","number","formControlName","tariff"],[1,"col-12"],["matInput","","formControlName","description"],["matInput","","formControlName","note"],[4,"ngIf"],[3,"ngClass"],[3,"options","images"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","","color","primary",3,"disabled","click"],["mat-button","","mat-dialog-close","","color","warn",3,"disabled"],[1,"my-2"],[1,"d-block","mat-card-header-m-0"],[1,"row","m-0",2,"display","flex"],[1,"col-sm-12","col-md-12"],[1,"mr-1",2,"color","#f44336","font-weight","bold"],[1,"col-md-7","d-flex","align-items-center"],[1,"text-muted","font-sm"],["mat-raised-button","",3,"click"],[1,"col-md-5"],["alt","",1,"w-100",3,"src"],["color","warn","mat-raised-button","",3,"click"],["alt","",1,"w-100",2,"height","200px","object-fit","contain",3,"src"]],template:function(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"mat-dialog-content")(1,"mat-drawer-container",0)(2,"mat-drawer",1,2)(4,"div",3),t._uU(5,"Buscar Producto "),t.qZA(),t.TgZ(6,"app-header-search",4),t.NdJ("products",function(l){return o.getProduct(l)}),t.qZA(),t.YNc(7,_t,35,9,"mat-card",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7),t._uU(10),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){t.CHM(n);const l=t.MAs(3);return t.KtG(l.toggle())}),t._uU(12," Vincular producto "),t.qZA(),t.TgZ(13,"span",9)(14,"label",10)(15,"mat-icon",11),t._uU(16,"backup"),t.qZA(),t.TgZ(17,"span"),t._uU(18," Agregar Imagen "),t.qZA()(),t.TgZ(19,"input",12),t.NdJ("change",function(l){return o.uploadImg(l)}),t.qZA()(),t.TgZ(20,"form",13)(21,"div",14)(22,"div",15)(23,"div",14)(24,"mat-form-field",16)(25,"mat-label"),t._uU(26,"Codigo"),t.qZA(),t._UZ(27,"input",17),t.qZA(),t.TgZ(28,"mat-form-field",16)(29,"mat-label"),t._uU(30,"Cantidad"),t.qZA(),t._UZ(31,"input",18),t.qZA(),t.TgZ(32,"mat-form-field",16)(33,"mat-label"),t._uU(34,"Precio u."),t.qZA(),t._UZ(35,"input",19),t.qZA(),t.TgZ(36,"mat-form-field",20)(37,"mat-label"),t._uU(38,"Es nuevo?"),t.qZA(),t.TgZ(39,"mat-select",21)(40,"mat-option",22),t._uU(41,"SI"),t.qZA(),t.TgZ(42,"mat-option",23),t._uU(43,"NO"),t.qZA()()(),t.TgZ(44,"mat-form-field",20)(45,"mat-label"),t._uU(46,"Arancel %"),t.qZA(),t._UZ(47,"input",24),t.qZA(),t.TgZ(48,"mat-form-field",25)(49,"mat-label"),t._uU(50,"Descripcion"),t.qZA(),t._UZ(51,"input",26),t.qZA(),t.TgZ(52,"mat-form-field",25)(53,"mat-label"),t._uU(54,"Observacion"),t.qZA(),t._UZ(55,"textarea",27),t.qZA()(),t.YNc(56,ft,35,9,"mat-card",28),t.qZA(),t.TgZ(57,"div",29),t._UZ(58,"ngx-gallery",30),t.qZA()()()()()(),t.TgZ(59,"div",31)(60,"button",32),t.NdJ("click",function(){return o.addItem()}),t._uU(61,"Guardar"),t.qZA(),t.TgZ(62,"button",33),t._uU(63,"Cancelar"),t.qZA()()}2&e&&(t.xp6(6),t.Q6J("init",!1)("url","catalogs/products"),t.xp6(1),t.Q6J("ngForOf",o.products),t.xp6(3),t.hij("",o.title," "),t.xp6(10),t.Q6J("formGroup",o.formMore),t.xp6(2),t.Q6J("ngClass",o.galleryImages.length>0?"col-md-7":"col-md-12"),t.xp6(34),t.Q6J("ngIf",o.product_relationship),t.xp6(1),t.Q6J("ngClass",t.VKq(12,gt,o.galleryImages.length>0)),t.xp6(1),t.Q6J("options",o.galleryOptions)("images",o.galleryImages),t.xp6(2),t.Q6J("disabled",o.formMore.invalid||o.isLoadItem),t.xp6(2),t.Q6J("disabled",o.isLoadItem))},dependencies:[r.mk,r.sg,r.O5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,x.lW,b.Hw,A.KE,A.hX,H.gD,J.ey,I.ZT,I.uh,I.xY,I.H8,_.a8,_.dk,_.dn,_.n5,L.Nt,et.jA,et.kh,O.H,at.g$]}),i})();var f=(()=>{return(i=f||(f={})).create_provider="create_provider",i.create_contact="create_contact",i.view_contact="view_contact",i.delete_provider="delete_provider",i.delete_contact="delete_contact",i.edit_provider="edit_provider",i.edit_contact="edit_contact",f;var i})(),E=m(86856),rt=m(20773),U=m(32075);function ht(i,a){if(1&i&&(t.TgZ(0,"mat-card-subtitle"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(e.provider_name)}}function vt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre es requerido "),t.qZA())}function bt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El Correo es requerido "),t.qZA())}function Zt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Correo invalido "),t.qZA())}function xt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El sitio web es requerido "),t.qZA())}function Ct(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El direccion es requerido "),t.qZA())}function Tt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El ciudad es requerido "),t.qZA())}function It(i,a){if(1&i&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function At(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El pa\xeds es requerido "),t.qZA())}function qt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El Tel\xe9fono es requerido "),t.qZA())}function Ut(i,a){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.closeDialogProviderCreate())}),t.TgZ(2,"div",3)(3,"div")(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),t._uU(7,"Nombre"),t.qZA(),t._UZ(8,"input",6),t.YNc(9,vt,2,0,"mat-error",1),t.qZA(),t.TgZ(10,"mat-form-field",5)(11,"mat-label"),t._uU(12,"Correo Electr\xf3nico"),t.qZA(),t._UZ(13,"input",7),t.YNc(14,bt,2,0,"mat-error",1),t.YNc(15,Zt,2,0,"mat-error",1),t.qZA(),t.TgZ(16,"mat-form-field",5)(17,"mat-label"),t._uU(18,"Sitio Web"),t.qZA(),t._UZ(19,"input",8),t.YNc(20,xt,2,0,"mat-error",1),t.qZA(),t.TgZ(21,"mat-form-field",5)(22,"mat-label"),t._uU(23,"Direccion"),t.qZA(),t._UZ(24,"input",9),t.YNc(25,Ct,2,0,"mat-error",1),t.qZA(),t.TgZ(26,"mat-form-field",10)(27,"mat-label"),t._uU(28,"Cuidad"),t.qZA(),t._UZ(29,"input",11),t.YNc(30,Tt,2,0,"mat-error",1),t.qZA(),t.TgZ(31,"mat-form-field",10)(32,"mat-label"),t._uU(33,"Escoja un pais"),t.qZA(),t.TgZ(34,"mat-select",12),t.YNc(35,It,2,2,"mat-option",13),t.qZA(),t.YNc(36,At,2,0,"mat-error",1),t.qZA(),t.TgZ(37,"mat-form-field",10)(38,"mat-label"),t._uU(39,"Tel\xe9fono"),t.qZA(),t._UZ(40,"input",14),t.YNc(41,qt,2,0,"mat-error",1),t.qZA()()()(),t.TgZ(42,"div",15)(43,"button",16),t._uU(44,"Guardar proveedor"),t.qZA(),t.TgZ(45,"button",17),t._uU(46,"Cancelar"),t.qZA()()(),t.BQk()}if(2&i){const e=t.oxw();let o,n,c,l,q,w,F,Q;t.xp6(1),t.Q6J("formGroup",e.formProvider),t.xp6(8),t.Q6J("ngIf",null==(o=e.formProvider.get("name"))?null:o.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(n=e.formProvider.get("email"))?null:n.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(c=e.formProvider.get("email"))?null:c.hasError("email")),t.xp6(5),t.Q6J("ngIf",null==(l=e.formProvider.get("website"))?null:l.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(q=e.formProvider.get("address"))?null:q.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(w=e.formProvider.get("city"))?null:w.hasError("required")),t.xp6(5),t.Q6J("ngForOf",e.countries),t.xp6(1),t.Q6J("ngIf",null==(F=e.formProvider.get("country_id"))?null:F.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(Q=e.formProvider.get("phone"))?null:Q.hasError("required")),t.xp6(2),t.Q6J("disabled",e.formProvider.invalid)}}function wt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre es requerido "),t.qZA())}function yt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El Telefono es requerido "),t.qZA())}function Ot(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El Correo es requerido "),t.qZA())}function kt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Correo invalido "),t.qZA())}function Et(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," El Cargo es requerido "),t.qZA())}function Nt(i,a){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.closeDialogContactCreate("create_contact"))}),t.TgZ(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),t._uU(6,"Nombre"),t.qZA(),t._UZ(7,"input",6),t.YNc(8,wt,2,0,"mat-error",1),t.qZA(),t.TgZ(9,"mat-form-field",5)(10,"mat-label"),t._uU(11,"Nombre"),t.qZA(),t._UZ(12,"input",14),t.YNc(13,yt,2,0,"mat-error",1),t.qZA(),t.TgZ(14,"mat-form-field",5)(15,"mat-label"),t._uU(16,"Correo Electronico"),t.qZA(),t._UZ(17,"input",7),t.YNc(18,Ot,2,0,"mat-error",1),t.YNc(19,kt,2,0,"mat-error",1),t.qZA(),t.TgZ(20,"mat-form-field",5)(21,"mat-label"),t._uU(22,"Cargo"),t.qZA(),t._UZ(23,"input",19),t.YNc(24,Et,2,0,"mat-error",1),t.qZA()()(),t.TgZ(25,"div",15)(26,"button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.closeDialogContactCreate("create_contact"))}),t._uU(27,"Guardar contacto"),t.qZA(),t.TgZ(28,"button",21),t._uU(29,"Cancelar"),t.qZA()()(),t.BQk()}if(2&i){const e=t.oxw();let o,n,c,l,q;t.xp6(1),t.Q6J("formGroup",e.formContact),t.xp6(7),t.Q6J("ngIf",null==(o=e.formContact.get("name"))?null:o.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(n=e.formContact.get("phone"))?null:n.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(c=e.formContact.get("email"))?null:c.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(l=e.formContact.get("email"))?null:l.hasError("email")),t.xp6(5),t.Q6J("ngIf",null==(q=e.formContact.get("position"))?null:q.hasError("required"))}}function Pt(i,a){1&i&&(t.TgZ(0,"div"),t._uU(1,"Sin Contactos"),t.qZA())}function Mt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card",23)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5),t.qZA(),t.TgZ(6,"mat-card-subtitle"),t._uU(7),t.qZA(),t.TgZ(8,"mat-card-subtitle"),t._uU(9),t.qZA()(),t.TgZ(10,"mat-card-actions")(11,"button",24),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.editContact(c.id))}),t._uU(12,"Editar"),t.qZA(),t.TgZ(13,"button",25),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.deleteContact(c.id))}),t._uU(14,"Eliminar"),t.qZA()()()}if(2&i){const e=a.$implicit;t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.email),t.xp6(2),t.Oqu(e.phone),t.xp6(2),t.Oqu(e.position)}}function Jt(i,a){if(1&i&&(t.ynx(0),t.YNc(1,Pt,2,0,"div",1),t.YNc(2,Mt,15,4,"mat-card",22),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.contacts.length<1),t.xp6(1),t.Q6J("ngForOf",e.contacts)}}let R=(()=>{class i{constructor(e,o){this.dialogRef=e,this.data=o,this.enum_action_provider=f,this.contacts=[],this.state=f.create_provider,this.formProvider=new s.cw({name:new s.NI(null,[s.kI.required]),phone:new s.NI(null),email:new s.NI(null,[s.kI.email]),website:new s.NI(null),address:new s.NI(null),city:new s.NI(null),country_id:new s.NI(null,[s.kI.required])}),this.formContact=new s.cw({name:new s.NI(null,[s.kI.required]),phone:new s.NI(null,[s.kI.required]),email:new s.NI(null,[s.kI.required,s.kI.email]),position:new s.NI(null,[s.kI.required]),id:new s.NI(null)}),this.countries=[]}ngOnInit(){if(this.data.hasOwnProperty("state"))switch(this.state=this.data.state,this.state){case f.edit_provider:const{name:e,phone:o,email:n,website:c,address:l,city:q,country_id:w}=this.data.form_data;this.formProvider.setValue({name:e,phone:o,email:n,website:c,address:l,city:q,country_id:w});break;case f.view_contact:this.contacts=this.data.form_data.contacts,this.provider_name=this.data.form_data.name_provider}this.countries=JSON.parse(localStorage.getItem("countries"))}closeDialogProviderCreate(){this.formProvider.valid&&this.dialogRef.close({success:!0,data:this.formProvider.value})}closeDialogContactCreate(e){this.formContact.valid&&(this.state==this.enum_action_provider.create_contact?this.dialogRef.close({success:!0,option:e,data:this.formContact.value}):this.state==this.enum_action_provider.edit_contact&&this.dialogRef.close({success:!0,action:this.enum_action_provider.edit_contact,data:this.formContact.value}))}editContact(e){const o=this.contacts.findIndex(n=>n.id==e);if(-1!==o){const{id:n,name:c,phone:l,email:q,position:w}=this.contacts[o];this.formContact.setValue({id:n,name:c,phone:l,email:q,position:w}),this.state=f.edit_contact}}deleteContact(e){const o=this.contacts.findIndex(n=>n.id==e);if(-1!==o){const{id:n,name:c,phone:l,email:q,position:w}=this.contacts[o];this.dialogRef.close({success:!0,action:this.enum_action_provider.delete_contact,data:{id:n,name:c,phone:l,email:q,position:w}})}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(I.so),t.Y36(I.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-create-provider-or-contact"]],decls:6,vars:5,consts:[["mat-dialog-title","",1,"font-5xl","font-facebook","list-group-item-accent-warning"],[4,"ngIf"],[3,"formGroup","ngSubmit"],["mat-dialog-content",""],[1,"row"],[1,"col-md-6"],["matInput","","formControlName","name"],["matInput","","formControlName","email"],["matInput","","formControlName","website"],["matInput","","formControlName","address"],[1,"col-md-4"],["matInput","","formControlName","city"],["formControlName","country_id"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","phone"],["mat-dialog-actions",""],["mat-raised-button","","type","submit","color","primary",3,"disabled"],["mat-raised-button","","type","button","mat-dialog-close","","cdkFocusInitial","","color","warn"],[3,"value"],["matInput","","formControlName","position"],["type","submit","mat-raised-button","","color","primary",3,"click"],["type","button","mat-raised-button","","mat-dialog-close","","cdkFocusInitial","","color","warn"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t._uU(1),t.qZA(),t.YNc(2,ht,2,1,"mat-card-subtitle",1),t.YNc(3,Ut,47,11,"ng-container",1),t.YNc(4,Nt,30,6,"ng-container",1),t.YNc(5,Jt,3,2,"ng-container",1)),2&e&&(t.xp6(1),t.Oqu(o.data.title),t.xp6(1),t.Q6J("ngIf",o.state==o.enum_action_provider.edit_contact),t.xp6(1),t.Q6J("ngIf",o.state==o.enum_action_provider.create_provider||o.state==o.enum_action_provider.edit_provider),t.xp6(1),t.Q6J("ngIf",o.state==o.enum_action_provider.create_contact||o.state==o.enum_action_provider.edit_contact),t.xp6(1),t.Q6J("ngIf",o.state==o.enum_action_provider.view_contact))},dependencies:[r.sg,r.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.lW,A.TO,A.KE,A.hX,H.gD,J.ey,I.ZT,I.uh,I.xY,I.H8,_.a8,_.dk,_.n5,_.$j,_.hq,L.Nt]}),i})();var ot=m(67399),it=m(14623),Lt=m(4834);function Ft(i,a){if(1&i){const e=t.EpF();t.ynx(0),t._UZ(1,"mat-divider"),t.TgZ(2,"mat-list-option",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createContact())}),t.TgZ(3,"mat-icon",2),t._uU(4,"person_add"),t.qZA(),t.TgZ(5,"div",3),t._uU(6,"Crear contacto"),t.qZA()(),t._UZ(7,"mat-divider"),t.TgZ(8,"mat-list-option",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.editProvider())}),t.TgZ(9,"mat-icon",2),t._uU(10,"edit"),t.qZA(),t.TgZ(11,"div",3),t._uU(12,"Editar Proveedor"),t.qZA(),t.TgZ(13,"div",3),t._uU(14),t.qZA()(),t._UZ(15,"mat-divider"),t.TgZ(16,"mat-list-option",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteProvider())}),t.TgZ(17,"mat-icon",2),t._uU(18,"delete"),t.qZA(),t.TgZ(19,"div",3),t._uU(20,"Eliminar Proveedor"),t.qZA(),t.TgZ(21,"div",3),t._uU(22),t.qZA()(),t._UZ(23,"mat-divider"),t.TgZ(24,"mat-list-option",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.viewContact())}),t.TgZ(25,"mat-icon",2),t._uU(26,"remove_red_eye"),t.qZA(),t.TgZ(27,"div",3),t._uU(28,"Ver contacto"),t.qZA(),t.TgZ(29,"div",3),t._uU(30),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(14),t.hij(" ",e.data.name," "),t.xp6(8),t.hij(" ",e.data.name," "),t.xp6(8),t.hij(" ",e.data.name," ")}}let Qt=(()=>{class i{constructor(e,o){this.data=e,this.sheet=o}ngOnInit(){}createProvider(){this.sheet.dismiss(f.create_provider)}createContact(){this.sheet.dismiss(f.create_contact)}viewContact(){this.sheet.dismiss(f.view_contact)}deleteProvider(){this.sheet.dismiss(f.delete_provider)}editProvider(){this.sheet.dismiss(f.edit_provider)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(ot.OG),t.Y36(ot.oL))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-action-provider"]],decls:7,vars:2,consts:[[3,"multiple"],[3,"click"],["mat-list-icon",""],["mat-line",""],[4,"ngIf"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-selection-list",0)(1,"mat-list-option",1),t.NdJ("click",function(){return o.createProvider()}),t.TgZ(2,"mat-icon",2),t._uU(3,"add"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Crear proveedor"),t.qZA()(),t.YNc(6,Ft,31,3,"ng-container",4),t.qZA()),2&e&&(t.Q6J("multiple",!1),t.xp6(6),t.Q6J("ngIf",o.data))},dependencies:[r.O5,b.Hw,J.X2,it.Nh,it.Ub,it.vS,Lt.d]}),i})();function St(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.closeInvoice())}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",e.isLoadInvoice)}}function Dt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.deleteInvoice())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",e.isLoadInvoice)}}function Yt(i,a){if(1&i&&(t.TgZ(0,"mat-option",20),t._uU(1),t.TgZ(2,"small",21),t._uU(3),t.qZA()()),2&i){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",null==e?null:e.name," "),t.xp6(2),t.hij("(",e.country.name,")")}}function Ht(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.cancelEditInvoice())}),t._uU(1," Ir a a\xf1adir item "),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",e.isLoadInvoice)}}function Gt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"form",3),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.saveInvoice())}),t.YNc(1,St,3,1,"button",4),t.YNc(2,Dt,3,1,"ng-template",null,5,t.W1O),t.TgZ(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Identificador"),t.qZA(),t._UZ(7,"input",6),t.qZA(),t.TgZ(8,"mat-form-field")(9,"mat-label"),t._uU(10,"Fecha"),t.qZA(),t._UZ(11,"input",7)(12,"mat-datepicker-toggle",8)(13,"mat-datepicker",9,10),t.qZA(),t.TgZ(15,"mat-form-field",11)(16,"mat-label"),t._uU(17,"Observacion"),t.qZA(),t._UZ(18,"textarea",12),t.qZA(),t.TgZ(19,"div",13)(20,"mat-form-field",11)(21,"mat-label"),t._uU(22,"Seleccione un Proveedor"),t.qZA(),t.TgZ(23,"mat-select",14),t.YNc(24,Yt,4,3,"mat-option",15),t.qZA()(),t.TgZ(25,"button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openActionProvider())}),t.TgZ(26,"mat-icon"),t._uU(27,"construction"),t.qZA()()(),t.TgZ(28,"button",17),t._uU(29,"Guardar"),t.qZA(),t.YNc(30,Ht,2,1,"button",18),t.qZA()}if(2&i){const e=t.MAs(3),o=t.MAs(14),n=t.oxw();t.Q6J("formGroup",n.formInvoice),t.xp6(1),t.Q6J("ngIf","create"===n.state)("ngIfElse",e),t.xp6(10),t.Q6J("matDatepicker",o),t.xp6(1),t.Q6J("for",o),t.xp6(12),t.Q6J("ngForOf",n.providers),t.xp6(4),t.Q6J("disabled",n.formInvoice.invalid||n.isLoadInvoice),t.xp6(2),t.Q6J("ngIf","create"!==n.state)}}function jt(i,a){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Es Nuevo?"),t.qZA())}function Kt(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.hij(" ",e.new," ")}}function Rt(i,a){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Codigo"),t.qZA())}function Bt(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.hij(" ",e.code," ")}}function $t(i,a){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Descripci\xf3n "),t.qZA())}function zt(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.hij(" ",e.description," ")}}function Wt(i,a){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Notas "),t.qZA())}function Xt(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.hij(" ",e.note," ")}}function Vt(i,a){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Cantidad "),t.qZA())}function te(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.hij(" ",e.quantity," ")}}function ee(i,a){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Precio "),t.qZA())}function oe(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.hij(" ",e.price," ")}}function ie(i,a){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Tarifa% "),t.qZA())}function ne(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.hij(" ",e.tariff," ")}}function ae(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-header-cell")(1,"button",44),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addRowTableItem())}),t.TgZ(2,"mat-icon"),t._uU(3,"post_add"),t.qZA()(),t.TgZ(4,"button",45)(5,"mat-icon"),t._uU(6,"backup"),t.qZA(),t._UZ(7,"label",46),t.TgZ(8,"input",47),t.NdJ("change",function(n){t.CHM(e);const c=t.oxw(2);return t.KtG(c.addFile(n))}),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(8),t.Q6J("disabled",e.isLoadFile)}}function re(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-cell")(1,"button",48),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.editItem(c.id))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",48),t.NdJ("click",function(){const c=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.deleteItem(c))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function se(i,a){1&i&&t._UZ(0,"mat-header-row")}function ce(i,a){1&i&&t._UZ(0,"mat-row")}function de(i,a){if(1&i&&(t.TgZ(0,"mat-card",49)(1,"mat-card-header",50)(2,"mat-card-title",51)(3,"div",52)(4,"span",53),t._uU(5),t.qZA(),t._uU(6),t.qZA()()(),t.TgZ(7,"mat-card-content")(8,"div",25)(9,"div",54)(10,"div")(11,"small",55),t._uU(12," Tipo: "),t.TgZ(13,"b"),t._uU(14),t.qZA(),t._uU(15," - C\xf3digo: "),t.TgZ(16,"b"),t._uU(17),t.qZA(),t._uU(18," - C\xf3digo Alternativo: "),t.TgZ(19,"b"),t._uU(20),t.qZA(),t._uU(21," - Categoria: "),t.TgZ(22,"b"),t._uU(23),t.qZA(),t._uU(24," - Marca: "),t.TgZ(25,"b"),t._uU(26),t.qZA(),t._uU(27," - Secuencia: "),t.TgZ(28,"b"),t._uU(29),t.qZA(),t._UZ(30,"br"),t.qZA(),t.TgZ(31,"button",56),t._uU(32,"Seleccionar"),t.qZA()()(),t.TgZ(33,"div",57),t._UZ(34,"img",58),t.qZA()()()()),2&i){const e=t.oxw(2);t.xp6(5),t.hij("#",e.product_relationship.id,""),t.xp6(1),t.hij("",e.product_relationship.name," "),t.xp6(8),t.Oqu(null==e.product_relationship.prefix?null:e.product_relationship.prefix.type),t.xp6(3),t.Oqu(e.product_relationship.code),t.xp6(3),t.Oqu(e.product_relationship.code_alt),t.xp6(3),t.Oqu(null==e.product_relationship.category?null:e.product_relationship.category.name),t.xp6(3),t.Oqu(null==e.product_relationship.brand?null:e.product_relationship.brand.name),t.xp6(3),t.Oqu(null==e.product_relationship.sequence?null:e.product_relationship.sequence.sequence_number),t.xp6(5),t.Q6J("src",e.captureImagenProduct(),t.LSH)}}function le(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",23)(1,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.editInvoice())}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteInvoice())}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()(),t.TgZ(7,"div",25)(8,"div",26)(9,"b"),t._uU(10,"Identificador"),t.qZA(),t.TgZ(11,"div",27),t._uU(12),t.qZA()(),t.TgZ(13,"div",28)(14,"b"),t._uU(15,"Fecha"),t.qZA(),t.TgZ(16,"div",27),t._uU(17),t.qZA()(),t.TgZ(18,"div",29)(19,"b"),t._uU(20,"Proveedor"),t.qZA(),t.TgZ(21,"div",27),t._uU(22),t.qZA()(),t.TgZ(23,"div",26)(24,"div"),t._uU(25,"Observaci\xf3n"),t.qZA(),t.TgZ(26,"div",27),t._uU(27),t.qZA()()(),t.TgZ(28,"div")(29,"mat-table",30),t.ynx(30,31),t.YNc(31,jt,2,0,"mat-header-cell",32),t.YNc(32,Kt,2,1,"mat-cell",33),t.BQk(),t.ynx(33,34),t.YNc(34,Rt,2,0,"mat-header-cell",32),t.YNc(35,Bt,2,1,"mat-cell",33),t.BQk(),t.ynx(36,35),t.YNc(37,$t,2,0,"mat-header-cell",32),t.YNc(38,zt,2,1,"mat-cell",33),t.BQk(),t.ynx(39,36),t.YNc(40,Wt,2,0,"mat-header-cell",32),t.YNc(41,Xt,2,1,"mat-cell",33),t.BQk(),t.ynx(42,37),t.YNc(43,Vt,2,0,"mat-header-cell",32),t.YNc(44,te,2,1,"mat-cell",33),t.BQk(),t.ynx(45,38),t.YNc(46,ee,2,0,"mat-header-cell",32),t.YNc(47,oe,2,1,"mat-cell",33),t.BQk(),t.ynx(48,39),t.YNc(49,ie,2,0,"mat-header-cell",32),t.YNc(50,ne,2,1,"mat-cell",33),t.BQk(),t.ynx(51,40),t.YNc(52,ae,9,1,"mat-header-cell",32),t.YNc(53,re,7,0,"mat-cell",33),t.BQk(),t.YNc(54,se,1,0,"mat-header-row",41),t.YNc(55,ce,1,0,"mat-row",42),t.qZA()(),t.YNc(56,de,35,9,"mat-card",43)}if(2&i){const e=t.oxw();t.xp6(12),t.Oqu(null==e.invoice?null:e.invoice.identifier),t.xp6(5),t.Oqu(null==e.invoice?null:e.invoice.date_purchase),t.xp6(5),t.Oqu(e.getProvider()),t.xp6(5),t.Oqu(null==e.invoice?null:e.invoice.notes),t.xp6(2),t.Q6J("dataSource",e.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",e.product_relationship)}}let st=(()=>{class i{constructor(e,o,n,c){this.snack=e,this.s_standart=o,this.bottomSheet=n,this.dialog=c,this.providers=[],this.product_relationship=null,this.state="create",this.invoice=null,this.formInvoice=new s.cw({identifier:new s.NI(null,[s.kI.required]),notes:new s.NI(null),date_purchase:new s.NI(null,[s.kI.required]),provider_id:new s.NI("",[s.kI.required]),id:new s.NI(null)}),this.close=new t.vpe,this.new_action=new t.vpe,this.isLoadInvoice=!1,this.isLoadFile=!1,this.ELEMENT_DATA=[],this.invoice_data=[],this.displayedColumns=["new","code","description","note","quantity","price","tariff","id"],this.dataSource=new U.by(this.ELEMENT_DATA)}ngOnInit(){if(this.invoice){const{date_purchase:e,id:o,identifier:n,notes:c,provider_id:l}=this.invoice;this.formInvoice.setValue({date_purchase:e,id:o,identifier:n,notes:c,provider_id:l}),this.refreshDataTable(this.ELEMENT_DATA)}}saveInvoice(){if(this.formInvoice.valid){if(this.isLoadInvoice=!0,null!=this.formInvoice.controls.date_purchase.value){const e=this.formInvoice.value;e.date_purchase=(0,r.p6)(new Date(e.date_purchase),"yyyy/MM/dd","en")}"edit"===this.state?this.s_standart.updatePut("purchase-department/imports/"+this.id_import+"/invoices/"+this.formInvoice.controls.id.value,this.formInvoice.value).subscribe(e=>{e.success&&(this.invoice=e.data,this.formInvoice.controls.id.setValue(e.data.id),this.formInvoice.disable({emitEvent:!0}),this.state="formMore"),this.isLoadInvoice=!1},()=>{this.isLoadInvoice=!1}):this.s_standart.store("purchase-department/imports/"+this.id_import+"/invoices",this.formInvoice.value).subscribe(e=>{e.hasOwnProperty("success")&&e.success&&(this.invoice=e.data,this.formInvoice.controls.id.setValue(e.data.id),this.formInvoice.disable({emitEvent:!0}),this.state="formMore"),this.isLoadInvoice=!1},()=>{this.isLoadInvoice=!1})}}cancelEditInvoice(){this.state="formMore"}editInvoice(){this.formInvoice.enable({emitEvent:!0}),this.state="edit"}openActionProvider(){const e=this.formInvoice.controls.provider_id.value,o=this.providers.findIndex(c=>c.id===e);let n;-1!==o&&(n=this.providers[o],this.bottomSheet.open(Qt,{data:n}).afterDismissed().subscribe(c=>{switch(c){case f.create_provider:this.dialog.open(R,{data:{title:"Crear Proveedor",isProvider:!0}}).beforeClosed().subscribe(l=>{l&&l.hasOwnProperty("success")&&l.success&&this.new_action.emit({action:f.create_provider,data:l.data})});break;case f.create_contact:this.dialog.open(R,{data:{title:"Crear Contacto",isProvider:!1,state:f.create_contact}}).beforeClosed().subscribe(l=>{l&&l.success&&this.new_action.emit({action:f.create_contact,data:l.data,id:n.id})});break;case f.view_contact:this.dialog.open(R,{data:{title:"Contactos",isProvider:!1,state:f.view_contact,form_data:{name_provider:n.name,contacts:n.contacts}}}).beforeClosed().subscribe(l=>{l&&l.success&&this.new_action.emit({action:l.action,data:l.data,id:n.id})});break;case f.delete_provider:this.new_action.emit({action:f.delete_provider,data:null,id:n.id});break;case f.edit_provider:this.dialog.open(R,{data:{title:"Editar Proveedor",isProvider:!0,form_data:n,state:f.edit_provider}}).beforeClosed().subscribe(l=>{l&&l.success&&this.new_action.emit({action:f.edit_provider,data:l.data,id:n.id})})}}))}addRowTableItem(){this.dialog.open(K,{data:{id_import:this.id_import,id_invoice:this.formInvoice.controls.id.value,state:"create"},disableClose:!0}).beforeClosed().subscribe(e=>{e&&e.hasOwnProperty("success")&&e.success&&this.refreshDataTable(e.data)})}deleteItem(e){const o=this.snack.open("Eliminando Item espera...");this.isLoadInvoice=!0,this.s_standart.destory("purchase-department/imports/"+this.id_import+"/invoices/"+this.formInvoice.controls.id.value+"/items/"+this.ELEMENT_DATA[e].id).subscribe(c=>{o.dismiss(),c&&c.hasOwnProperty("success")&&c.success?(this.snack.open("Eliminado con exito","Ok",{duration:2500}),this.refreshDataTable(c.data.invoice.items)):this.snack.open("Error intentalo de nuevo","Error",{duration:2500}),this.isLoadInvoice=!1},c=>{this.isLoadInvoice=!1,console.log(c),o.dismiss(),this.snack.open("Error intentalo de nuevo","Error",{duration:2500})})}refreshDataTable(e){const o=e;this.invoice_data=Object.assign(o,[]),this.ELEMENT_DATA=o,this.dataSource=new U.by(this.ELEMENT_DATA)}closeInvoice(){this.close.emit()}editItem(e){const o=this.invoice_data.find(n=>n.id===e);o?this.dialog.open(K,{data:{id_import:this.id_import,id_invoice:this.formInvoice.controls.id.value,state:"edit",formData:o},disableClose:!0}).beforeClosed().subscribe(n=>{n&&n.hasOwnProperty("success")&&n.success&&this.refreshDataTable(n.data)}):V.J.swalToast("Error a tratar de editar","error")}deleteInvoice(){const e=this.snack.open("Eliminando Factura espera...");this.isLoadInvoice=!0,this.s_standart.destory("purchase-department/imports/"+this.id_import+"/invoices/"+this.formInvoice.controls.id.value).subscribe(o=>{e.dismiss(),o.success?(this.snack.open("Eliminado con exito","Ok",{duration:2500}),this.closeInvoice()):this.snack.open("Error intentalo de nuevo","Error",{duration:2500}),this.isLoadInvoice=!1},o=>{this.isLoadInvoice=!1,console.log(o),e.dismiss(),this.snack.open("Error intentalo de nuevo","Error",{duration:2500})})}captureImagenProduct(){var e;return(null===(e=this.product_relationship)||void 0===e?void 0:e.prestashop_products.length)>0?this.product_relationship.prestashop_product[0].image:this.product_relationship.ml_infos.length>0?this.product_relationship.ml_infos[0].image:"assets/img/img_default_null.jpg"}addFile(e){this.isLoadFile=!0,this.s_standart.uploadImg("purchase-department/imports/"+this.id_import+"/invoices/"+this.formInvoice.controls.id.value+"/items/import",e.target.files[0],"file").subscribe(n=>{n.success&&V.J.swalToast("Los item del archive se han guardado en la base datos con exito","success"),this.isLoadFile=!1},()=>{this.isLoadFile=!1})}getProvider(){var e;return null===(e=this.providers.find(o=>{var n;return o.id===(null===(n=this.invoice)||void 0===n?void 0:n.provider_id)}))||void 0===e?void 0:e.name}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(j.ux),t.Y36(v.X),t.Y36(ot.ch),t.Y36(I.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-invoice-create-or-edit"]],inputs:{providers:"providers",id_import:"id_import",product_relationship:"product_relationship",state:"state",invoice:"invoice",ELEMENT_DATA:"ELEMENT_DATA"},outputs:{close:"close",new_action:"new_action"},decls:4,vars:2,consts:[[1,"my-4","border-0","shadow","rounded-fz"],["class","position-relative",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["formMore",""],[1,"position-relative",3,"formGroup","ngSubmit"],["mat-icon-button","","class","bg-gray-300","style","position: absolute;right: 10px;top: -30px;",3,"disabled","click",4,"ngIf","ngIfElse"],["removeInvoice",""],["matInput","","formControlName","identifier"],["matInput","","formControlName","date_purchase",3,"matDatepicker"],["matSuffix","",3,"for"],["disabled","false"],["dp5",""],[1,"w-100"],["matInput","","formControlName","notes"],[1,"d-flex"],["formControlName","provider_id"],[3,"value",4,"ngFor","ngForOf"],["mat-mini-fab","","color","primary","type","button",1,"mx-3",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","type","button",3,"disabled","click",4,"ngIf"],["mat-icon-button","",1,"bg-gray-300",2,"position","absolute","right","10px","top","-30px",3,"disabled","click"],[3,"value"],[1,"text-primary"],["mat-raised-button","","type","button",3,"disabled","click"],[2,"z-index","10","position","absolute","right","10px","top","-23px"],["mat-icon-button","",1,"bg-gray-300",3,"click"],[1,"row"],[1,"col-md-3"],[1,"text-success","text-break"],[1,"col-md-2"],[1,"col-md-4"],[1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","new"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","code"],["matColumnDef","description"],["matColumnDef","note"],["matColumnDef","quantity"],["matColumnDef","price"],["matColumnDef","tariff"],["matColumnDef","id"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["class","my-1",4,"ngIf"],["mat-icon-button","","color","accent",3,"click"],["mat-icon-button","","color","accent"],["for","file-excel",1,"m-0","h-100","w-100","position-absolute",2,"top","0","right","0"],["type","file","id","file-excel","accept",".xlsx",1,"d-none",3,"disabled","change"],["mat-icon-button","",3,"click"],[1,"my-1"],[1,"d-block","mat-card-header-m-0"],[1,"row",2,"display","flex"],[1,"col-sm-12","col-md-12"],[1,"mr-1",2,"color","#f44336","font-weight","bold"],[1,"col-md-6","d-flex","align-items-center"],[1,"text-muted","font-sm"],["mat-raised-button",""],[1,"col-md-6"],["alt","",1,"w-100",3,"src"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-card",0),t.YNc(1,Gt,31,8,"form",1),t.YNc(2,le,57,8,"ng-template",null,2,t.W1O),t.qZA()),2&e){const n=t.MAs(3);t.xp6(1),t.Q6J("ngIf","create"===o.state||"edit"===o.state)("ngIfElse",n)}},dependencies:[r.sg,r.O5,A.KE,A.hX,A.R9,H.gD,J.ey,_.a8,_.dk,_.dn,_.n5,s._Y,s.Fj,s.JJ,s.JL,b.Hw,x.lW,s.sg,s.u,L.Nt,E.Mq,E.hl,E.nW,U.BZ,U.fO,U.as,U.w1,U.Dz,U.nj,U.ge,U.ev,U.XQ,U.Gk]}),i})();function me(i,a){if(1&i&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function pe(i,a){1&i&&t._UZ(0,"mat-spinner",12),2&i&&t.Q6J("diameter",20)}function ue(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card",2)(1,"form",3),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createimport())}),t.TgZ(2,"mat-card-title"),t._uU(3,"Creando importacion"),t.qZA(),t.TgZ(4,"mat-form-field",4)(5,"mat-select",5),t.YNc(6,me,2,2,"mat-option",6),t.qZA()(),t.TgZ(7,"mat-form-field",4)(8,"mat-label"),t._uU(9,"Secuencia"),t.qZA(),t._UZ(10,"input",7),t.qZA(),t.TgZ(11,"div",8)(12,"button",9),t._uU(13,"Generar "),t.YNc(14,pe,1,1,"mat-spinner",10),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form_import),t.xp6(5),t.Q6J("ngForOf",e.origins),t.xp6(6),t.Q6J("disabled",e.form_import.invalid||e.isLoadGenerate),t.xp6(2),t.Q6J("ngIf",e.isLoadGenerate)}}function _e(i,a){if(1&i&&(t.TgZ(0,"mat-chip"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" LLeg\xf3 el ",t.lcZ(2,1,e.import.arrival_date)," ")}}function fe(i,a){if(1&i&&(t.TgZ(0,"mat-chip"),t._uU(1," FECHA ESTIMADA: "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"date"),t.qZA(),t._uU(5,"\xa0 y\xa0 "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"date"),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(3),t.hij("Entre \xa0",t.lcZ(4,2,e.import.estimated_date_first),""),t.xp6(4),t.Oqu(t.lcZ(8,4,e.import.estimated_date_last))}}function ge(i,a){if(1&i&&(t.TgZ(0,"div",28)(1,"div")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5," C\xf3digo: "),t.TgZ(6,"b"),t._uU(7),t.qZA()()(),t.TgZ(8,"mat-chip-list",29)(9,"mat-chip"),t._uU(10),t.qZA(),t.TgZ(11,"mat-chip"),t._uU(12,"Productos: "),t.TgZ(13,"b"),t._uU(14),t.qZA()(),t.TgZ(15,"mat-chip"),t._uU(16,"Promociones: "),t.TgZ(17,"b"),t._uU(18),t.qZA()(),t.YNc(19,_e,3,3,"mat-chip",30),t.YNc(20,fe,9,6,"ng-template",null,31,t.W1O),t.qZA()()),2&i){const e=t.MAs(21),o=t.oxw(2);t.xp6(3),t.AsE("Importaci\xf3n ",o.import.sequence.origin.name," #",o.import.sequence.sequence_number," "),t.xp6(4),t.Oqu(o.import.code),t.xp6(3),t.Oqu(null==o.import.last_status?null:o.import.last_status.status.name),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.product_import_count),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.promotion_count),t.xp6(1),t.Q6J("ngIf",o.import.arrival_date)("ngIfElse",e)}}function he(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"app-invoice-create-or-edit",32),t.NdJ("new_action",function(n){t.CHM(e);const c=t.oxw(2);return t.KtG(c.newAction(n))})("close",function(){const c=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.deleteInvoice(c))}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("id_import",null==e.import?null:e.import.id)("providers",e.providers)}}function ve(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card",2)(1,"mat-card-content",13)(2,"div"),t.YNc(3,ge,22,8,"div",14),t.TgZ(4,"div")(5,"div",15),t._uU(6,"Facturas "),t.TgZ(7,"button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.newInvoice())}),t.TgZ(8,"mat-icon"),t._uU(9,"add"),t.qZA()()(),t.YNc(10,he,2,2,"div",17),t.qZA(),t.TgZ(11,"div",18)(12,"div",15),t._uU(13,"Fecha estimada de llegada"),t.qZA(),t.TgZ(14,"div",19)(15,"mat-form-field",20)(16,"mat-label"),t._uU(17,"Inicio"),t.qZA(),t._UZ(18,"input",21)(19,"mat-datepicker-toggle",22)(20,"mat-datepicker",23,24),t.qZA(),t.TgZ(22,"mat-form-field")(23,"mat-label"),t._uU(24,"Final"),t.qZA(),t._UZ(25,"input",25)(26,"mat-datepicker-toggle",22)(27,"mat-datepicker",23,26),t.qZA()(),t.TgZ(29,"button",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.publishNow())}),t._uU(30,"Publicar"),t.qZA()()()()()}if(2&i){const e=t.MAs(21),o=t.MAs(28),n=t.oxw();t.xp6(3),t.Q6J("ngIf",n.import),t.xp6(7),t.Q6J("ngForOf",n.forms_invoices),t.xp6(1),t.Q6J("formGroup",n.form_publish),t.xp6(7),t.Q6J("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(6),t.Q6J("matDatepicker",o),t.xp6(1),t.Q6J("for",o),t.xp6(3),t.Q6J("disabled",n.form_publish.invalid)}}let be=(()=>{class i{constructor(e,o,n,c,l){this.snack_bar=e,this.active_route=o,this.spinner=n,this.s_standart=c,this.dialog=l,this.isLoadingProvider=!1,this.providers=[],this.state_import="create",this.products=[],this.form_import=new s.cw({origin:new s.NI("",[s.kI.required]),sequence:new s.NI("")}),this.form_publish=new s.cw({estimated_date_first:new s.NI(null,[s.kI.required]),estimated_date_last:new s.NI(null,[s.kI.required])}),this.forms_invoices=[],this.origins=[],this.files=[],this.isLoadGenerate=!1,this.state="create"}ngOnInit(){this.s_standart.create("purchase-department/imports/create").subscribe(e=>{({origins:this.origins,providers:this.providers}=e.data),localStorage.setItem("countries",JSON.stringify(e.data.countries))}),this.suscribe_status=this.active_route.data.subscribe(e=>{this.state_import=e.state,this.state=this.state_import,"edit"==e.state&&(this.spinner.show(),this.active_route.params.subscribe(o=>{this.s_standart.show("purchase-department/imports/"+o.id+"/edit").subscribe(n=>{this.spinner.hide(),this.import=n.data,this.forms_invoices=this.import.invoices},()=>{this.spinner.hide()})}))})}createimport(){this.form_import.valid&&(this.isLoadGenerate=!0,this.s_standart.store("purchase-department/imports",this.form_import.value).subscribe(e=>{e.success&&(this.import=e.data,this.state_import="edit"),this.isLoadGenerate=!1},()=>{this.isLoadGenerate=!1}))}ngOnDestroy(){this.suscribe_status&&this.suscribe_status.unsubscribe()}newInvoice(){this.forms_invoices.push("add")}removeInvoice(e){this.forms_invoices.splice(e,1)}dropped(e){this.files=e}deleteInvoice(e){this.forms_invoices.splice(e,1)}captureImagenProduct(e){return this.products[e].prestashop_products.length>0?this.products[e].prestashop_product[0].image:this.products[e].ml_infos.length>0?this.products[e].ml_infos[0].image:"assets/img/img_default_null.jpg"}addRowTableItem(){this.dialog.open(K,{data:{id_import:100,id_invoice:100},disableClose:!0})}getProduct(e){this.products=e.data.data}publishNow(){if(this.form_publish.valid){this.spinner.show();const e=this.form_publish.value;e.estimated_date_first=(0,r.p6)(new Date(e.estimated_date_first),"yyyy/MM/dd","en"),e.estimated_date_last=(0,r.p6)(new Date(e.estimated_date_last),"yyyy/MM/dd","en"),this.s_standart.updatePut("purchase-department/imports/"+this.import.id+"/publish",this.form_publish.value).subscribe(()=>{this.spinner.hide()},o=>{console.log(o),this.spinner.hide()})}}newAction(e){let o;switch(e.action){case f.create_provider:o=this.snack_bar.open("Creando proveedor espere..."),this.s_standart.store("purchase-department/providers",e.data).subscribe(n=>{n.success&&(o.dismiss(),this.snack_bar.open("Proveedor creado con \xe9xito","OK",{duration:2e3}),this.providers=n.data)},n=>{console.log(n),o.dismiss()});break;case f.create_contact:o=this.snack_bar.open("Creando contacto espere..."),this.s_standart.store(`purchase-department/providers/${e.id}/contacts`,e.data).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Contacto creado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.edit_provider:o=this.snack_bar.open("Editando proveedor espere..."),this.s_standart.updatePut(`purchase-department/providers/${e.id}`,e.data).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Proveedor editado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.delete_provider:o=this.snack_bar.open("Eliminando proveedor espere..."),this.s_standart.destory(`purchase-department/providers/${e.id}`).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Proveedor eliminado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.edit_contact:o=this.snack_bar.open("Editando contacto espere..."),this.s_standart.updatePut(`purchase-department/providers/${e.id}/contacts/${e.data.id}`,e.data).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Contacto editado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.delete_contact:o=this.snack_bar.open("Eliminando contacto espere..."),this.s_standart.destory(`purchase-department/providers/${e.id}/contacts/${e.data.id}`).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Contacto eliminado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()})}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(j.ux),t.Y36(C.gz),t.Y36(tt.t2),t.Y36(v.X),t.Y36(I.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-create-import"]],decls:4,vars:2,consts:[["class","my-1",4,"ngIf","ngIfElse"],["importGenerate",""],[1,"my-1"],[3,"formGroup","ngSubmit"],[1,"d-block"],["placeholder","Origen","formControlName","origin"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","sequence","type","number"],[1,"w-100"],["mat-raised-button","","type","submit",1,"d-flex",3,"disabled"],[3,"diameter",4,"ngIf"],[3,"value"],[3,"diameter"],[1,"header",2,"padding-bottom","5px","text-transform","uppercase"],["class","mb-3",4,"ngIf"],[1,"font-2xl","font-facebook"],["mat-mini-fab","",3,"click"],[4,"ngFor","ngForOf"],[3,"formGroup"],[1,"my-2"],[1,"mr-2"],["matInput","","formControlName","estimated_date_first","disabled","",3,"matDatepicker"],["matSuffix","",3,"for"],["disabled","false"],["dp3",""],["matInput","","formControlName","estimated_date_last","disabled","",3,"matDatepicker"],["dp4",""],["mat-raised-button","",3,"disabled","click"],[1,"mb-3"],["aria-label","Fish selection"],[4,"ngIf","ngIfElse"],["dateBetween",""],[3,"id_import","providers","new_action","close"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,ue,15,4,"mat-card",0),t.YNc(2,ve,31,8,"ng-template",null,1,t.W1O),t.qZA()),2&e){const n=t.MAs(3);t.xp6(1),t.Q6J("ngIf","create"===o.state_import)("ngIfElse",n)}},dependencies:[r.sg,r.O5,A.KE,A.hX,A.R9,H.gD,J.ey,_.a8,_.dn,_.n5,_.$j,s._Y,s.Fj,s.wV,s.JJ,s.JL,b.Hw,x.lW,s.sg,s.u,L.Nt,g.qn,g.HS,E.Mq,E.hl,E.nW,rt.Ou,st,r.uU]}),i})();function Ze(i,a){if(1&i&&(t.TgZ(0,"mat-chip"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" LLeg\xf3 el ",t.lcZ(2,1,e.import.arrival_date)," ")}}function xe(i,a){if(1&i&&(t.TgZ(0,"mat-chip"),t._uU(1," FECHA ESTIMADA: "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"date"),t.qZA(),t._uU(5,"\xa0 y\xa0 "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"date"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(3),t.hij("Entre \xa0",t.lcZ(4,2,e.import.estimated_date_first),""),t.xp6(4),t.Oqu(t.lcZ(8,4,e.import.estimated_date_last))}}function Ce(i,a){if(1&i&&(t.TgZ(0,"div",17)(1,"div")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5," C\xf3digo: "),t.TgZ(6,"b"),t._uU(7),t.qZA()()(),t.TgZ(8,"mat-chip-list",18)(9,"mat-chip"),t._uU(10),t.qZA(),t.TgZ(11,"mat-chip"),t._uU(12,"Productos: "),t.TgZ(13,"b"),t._uU(14),t.qZA()(),t.TgZ(15,"mat-chip"),t._uU(16,"Promociones: "),t.TgZ(17,"b"),t._uU(18),t.qZA()(),t.YNc(19,Ze,3,3,"mat-chip",19),t.YNc(20,xe,9,6,"ng-template",null,20,t.W1O),t.qZA()()),2&i){const e=t.MAs(21),o=t.oxw();t.xp6(3),t.AsE("Importaci\xf3n ",null==o.import||null==o.import.sequence||null==o.import.sequence.origin?null:o.import.sequence.origin.name," #",null==o.import||null==o.import.sequence?null:o.import.sequence.sequence_number," "),t.xp6(4),t.Oqu(null==o.import?null:o.import.code),t.xp6(3),t.Oqu(null==o.import.last_status?null:o.import.last_status.status.name),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.product_import_count),t.xp6(4),t.Oqu(null==o.import.Counts?null:o.import.Counts.promotion_count),t.xp6(1),t.Q6J("ngIf",o.import.arrival_date)("ngIfElse",e)}}function Te(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"app-invoice-create-or-edit",21),t.NdJ("new_action",function(n){t.CHM(e);const c=t.oxw();return t.KtG(c.changeProviders(n))})("close",function(){const c=t.CHM(e).index,l=t.oxw();return t.KtG(l.deleteInvoice(c))}),t.qZA()()}if(2&i){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ELEMENT_DATA",null==e?null:e.items)("invoice",e)("id_import",null==o.import?null:o.import.id)("providers",o.providers)("state",e?"edit":"create")}}let Ie=(()=>{class i{constructor(e,o,n,c,l){this.active_route=e,this.spinner=o,this.s_standart=n,this.dialog=c,this.snack_bar=l,this.isLoadingProvider=!1,this.providers=[],this.products=[],this.form_publish=new s.cw({estimated_date_first:new s.NI(null,[s.kI.required]),estimated_date_last:new s.NI(null,[s.kI.required])}),this.forms_invoices=[],this.import=null,this.origins=[],this.isLoadGenerate=!1,this.state="create"}ngOnInit(){this.s_standart.create("purchase-department/imports/create").subscribe(e=>{({origins:this.origins,providers:this.providers}=e.data)}),this.suscribe_status=this.active_route.data.subscribe(()=>{this.spinner.show(),this.active_route.params.subscribe(e=>{this.s_standart.show("purchase-department/imports/"+e.id+"/edit").subscribe(o=>{this.spinner.hide(),this.import=o.data,this.forms_invoices=this.import.invoices},()=>{this.spinner.hide()})})})}changeProviders(e){let o;switch(e.action){case f.create_provider:o=this.snack_bar.open("Creando proveedor espere..."),this.s_standart.store("purchase-department/providers",e.data).subscribe(n=>{n.success&&(o.dismiss(),this.snack_bar.open("Proveedor creado con \xe9xito","OK",{duration:2e3}),this.providers=n.data)},n=>{console.log(n),o.dismiss()});break;case f.create_contact:o=this.snack_bar.open("Creando contacto espere..."),this.s_standart.store(`purchase-department/providers/${e.id}/contacts`,e.data).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Contacto creado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.edit_provider:o=this.snack_bar.open("Editando proveedor espere..."),this.s_standart.updatePut(`purchase-department/providers/${e.id}`,e.data).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Proveedor editado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.delete_provider:o=this.snack_bar.open("Eliminando proveedor espere..."),this.s_standart.destory(`purchase-department/providers/${e.id}`).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Proveedor eliminado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.edit_contact:o=this.snack_bar.open("Editando contacto espere..."),this.s_standart.updatePut(`purchase-department/providers/${e.id}/contacts/${e.data.id}`,e.data).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Contacto editado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()});break;case f.delete_contact:o=this.snack_bar.open("Eliminando contacto espere..."),this.s_standart.destory(`purchase-department/providers/${e.id}/contacts/${e.data.id}`).subscribe(n=>{n.success&&(o.dismiss(),this.providers=n.data,this.snack_bar.open("Contacto eliminado con \xe9xito","OK",{duration:2e3}))},n=>{console.log(n),o.dismiss()})}}ngOnDestroy(){this.suscribe_status&&this.suscribe_status.unsubscribe()}newInvoice(){var e;null===(e=this.forms_invoices)||void 0===e||e.push(null)}removeInvoice(e){var o;null===(o=this.forms_invoices)||void 0===o||o.splice(e,1)}deleteInvoice(e){var o;null===(o=this.forms_invoices)||void 0===o||o.splice(e,1)}captureImagenProduct(e){return this.products[e].prestashop_products.length>0?this.products[e].prestashop_product[0].image:this.products[e].ml_infos.length>0?this.products[e].ml_infos[0].image:"assets/img/img_default_null.jpg"}addRowTableItem(){this.dialog.open(K,{data:{id_import:100,id_invoice:100},disableClose:!0})}getProduct(e){this.products=e.data.data}publishNow(){var e;if(this.form_publish.valid){this.spinner.show();const o=this.form_publish.value;o.estimated_date_first=(0,r.p6)(new Date(o.estimated_date_first),"yyyy/MM/dd","en"),o.estimated_date_last=(0,r.p6)(new Date(o.estimated_date_last),"yyyy/MM/dd","en"),this.s_standart.updatePut("purchase-department/imports/"+(null===(e=this.import)||void 0===e?void 0:e.id)+"/publish",this.form_publish.value).subscribe(()=>{this.spinner.hide()},n=>{console.log(n),this.spinner.hide()})}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(C.gz),t.Y36(tt.t2),t.Y36(v.X),t.Y36(I.uw),t.Y36(j.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-import"]],decls:34,vars:8,consts:[[1,"my-1"],[1,"header",2,"padding-bottom","5px","text-transform","uppercase"],["class","mb-3",4,"ngIf"],[1,"shadow","rounded-fz","card-body","mb-3"],[1,"font-2xl","font-facebook"],[4,"ngFor","ngForOf"],["color","accent","mat-flat-button","",1,"mt-2",3,"click"],[3,"formGroup"],[1,"my-2"],[1,"mr-2"],["matInput","","formControlName","estimated_date_first","disabled","",3,"matDatepicker"],["matSuffix","",3,"for"],["disabled","false"],["dp3",""],["matInput","","formControlName","estimated_date_last","disabled","",3,"matDatepicker"],["dp4",""],["mat-raised-button","",3,"disabled","click"],[1,"mb-3"],["aria-label","Fish selection"],[4,"ngIf","ngIfElse"],["dateBetween",""],[3,"ELEMENT_DATA","invoice","id_import","providers","state","new_action","close"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div")(1,"div")(2,"mat-card",0)(3,"mat-card-content",1)(4,"div"),t.YNc(5,Ce,22,8,"div",2),t.TgZ(6,"div",3)(7,"div",4),t._uU(8,"Facturas "),t.qZA(),t.YNc(9,Te,2,5,"div",5),t.TgZ(10,"button",6),t.NdJ("click",function(){return o.newInvoice()}),t._uU(11," Agregar nueva factura "),t.TgZ(12,"mat-icon"),t._uU(13,"add"),t.qZA()()(),t.TgZ(14,"div",7)(15,"div",4),t._uU(16,"Fecha estimada de llegada"),t.qZA(),t.TgZ(17,"div",8)(18,"mat-form-field",9)(19,"mat-label"),t._uU(20,"Inicio"),t.qZA(),t._UZ(21,"input",10)(22,"mat-datepicker-toggle",11)(23,"mat-datepicker",12,13),t.qZA(),t.TgZ(25,"mat-form-field")(26,"mat-label"),t._uU(27,"Final"),t.qZA(),t._UZ(28,"input",14)(29,"mat-datepicker-toggle",11)(30,"mat-datepicker",12,15),t.qZA()(),t.TgZ(32,"button",16),t.NdJ("click",function(){return o.publishNow()}),t._uU(33,"Publicar"),t.qZA()()()()()()()),2&e){const n=t.MAs(24),c=t.MAs(31);t.xp6(5),t.Q6J("ngIf",o.import),t.xp6(4),t.Q6J("ngForOf",o.forms_invoices),t.xp6(5),t.Q6J("formGroup",o.form_publish),t.xp6(7),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(6),t.Q6J("matDatepicker",c),t.xp6(1),t.Q6J("for",c),t.xp6(3),t.Q6J("disabled",o.form_publish.invalid)}},dependencies:[r.sg,r.O5,A.KE,A.hX,A.R9,_.a8,_.dn,_.n5,_.$j,s.Fj,s.JJ,s.JL,b.Hw,x.lW,s.sg,s.u,L.Nt,g.qn,g.HS,E.Mq,E.hl,E.nW,st,r.uU]}),i})();const Ae=function(){return[""]};let ct=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-in-construction"]],decls:16,vars:2,consts:[[1,"vh-100"],[1,"d-flex","h-100","align-items-center"],[1,"row","m-0","p-0","w-100"],[1,"col-md-6","col-12","d-flex","align-items-center"],[1,""],[1,"display-3"],[1,"display-4"],[1,"lead"],[1,"my-4"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"col-md-6","col-12"],["src","/assets/img/section_construction.svg","alt","seccion en construccion"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t._uU(6,"Ups!"),t.qZA(),t.TgZ(7,"div",6),t._uU(8,"Esta secci\xf3n esta en construcci\xf3n"),t.qZA(),t.TgZ(9,"p",7),t._uU(10,"Esta seccion se esta construyendo en este momento"),t.qZA(),t._UZ(11,"hr",8),t.TgZ(12,"button",9),t._uU(13,"Ir a panel de control"),t.qZA()()(),t.TgZ(14,"div",10),t._UZ(15,"img",11),t.qZA()()()()),2&e&&(t.xp6(12),t.Q6J("routerLink",t.DdM(1,Ae)))},dependencies:[C.rH,x.lW]}),i})();const qe=[{path:"",children:[{path:"index",component:pt},{path:"create",component:be,data:{state:"create"}},{path:"edit/:id",component:Ie,data:{state:"edit"}},{path:"codificar-importaciones",component:ct},{path:"precios-promociones",component:ct}]}];let Ue=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[C.Bz.forChild(qe),C.Bz]}),i})();var we=m(9178),ye=m(86087),Oe=m(92181);let ke=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[r.ez,_.QW,g.Hi,Oe.Tx,b.Ps,N.VI.forChild(),x.ot]}),i})();var Ee=m(99523),Ne=m(91079),Pe=m(5434);let Me=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[r.ez,Ue,we.q,A.lN,H.LD,_.QW,s.u5,Z.hx,ye.TU,ke,b.Ps,x.ot,s.UX,L.c,g.Hi,E.FA,J.XK,Ee.Yi,Ne.Bb,rt.Cq,U.p0,et.SJ,Pe.E]}),i})()},84909:(B,P,m)=>{m.d(P,{xr:()=>Y,hx:()=>T});var r=m(5e3);const C="undefined"!=typeof performance&&void 0!==performance.now&&"function"==typeof performance.mark&&"function"==typeof performance.measure&&("function"==typeof performance.clearMarks||"function"==typeof performance.clearMeasures),y="undefined"!=typeof PerformanceObserver&&void 0!==PerformanceObserver.prototype&&"function"==typeof PerformanceObserver.prototype.constructor,t="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);let O={},_={};const Z=()=>C?performance.now():Date.now(),v=p=>{O[p]=void 0,_[p]&&(_[p]=void 0),C&&(t||performance.clearMeasures(p),performance.clearMarks(p))},g=p=>{if(C){if(t&&y){const u=new PerformanceObserver(d=>{_[p]=d.getEntries().find(h=>h.name===p),u.disconnect()});u.observe({entryTypes:["measure"]})}performance.mark(p)}O[p]=Z()},b=(p,u)=>{try{const d=O[p];return C?(u||performance.mark(`${p}-end`),performance.measure(p,p,u||`${p}-end`),t?_[p]?_[p]:d?{duration:Z()-d,startTime:d,entryType:"measure",name:p}:{}:performance.getEntriesByName(p).pop()||{}):d?{duration:Z()-d,startTime:d,entryType:"measure",name:p}:{}}catch(d){return{}}finally{v(p),v(u||`${p}-end`)}};var x=m(69808);const S=function(p,u,d,h){return{circle:p,progress:u,"progress-dark":d,pulse:h}};function D(p,u){if(1&p&&r._UZ(0,"span",1),2&p){const d=r.oxw();r.Q6J("ngClass",r.l5B(4,S,"circle"===d.appearance,"progress"===d.animation,"progress-dark"===d.animation,"pulse"===d.animation))("ngStyle",d.theme),r.uIk("aria-label",d.ariaLabel)("aria-valuetext",d.loadingText)}}const M=new r.OlP("ngx-skeleton-loader.config");let Y=(()=>{class p{constructor(d){const{appearance:h="line",animation:k="progress",theme:$=null,loadingText:z="Loading...",count:W=1,ariaLabel:X="loading"}=d||{};this.appearance=h,this.animation=k,this.theme=$,this.loadingText=z,this.count=W,this.items=[],this.ariaLabel=X}ngOnInit(){g("NgxSkeletonLoader:Rendered"),g("NgxSkeletonLoader:Loaded"),this.validateInputValues()}validateInputValues(){/^\d+$/.test(`${this.count}`)||((0,r.X6Q)()&&console.error("`NgxSkeletonLoaderComponent` need to receive 'count' a numeric value. Forcing default to \"1\"."),this.count=1),this.items.length=this.count;const d=["progress","progress-dark","pulse","false"];-1===d.indexOf(String(this.animation))&&((0,r.X6Q)()&&console.error(`\`NgxSkeletonLoaderComponent\` need to receive 'animation' as: ${d.join(", ")}. Forcing default to "progress".`),this.animation="progress"),-1===["circle","line",""].indexOf(String(this.appearance))&&((0,r.X6Q)()&&console.error("`NgxSkeletonLoaderComponent` need to receive 'appearance' as: circle or line or empty string. Forcing default to \"''\"."),this.appearance="")}ngOnChanges(d){["count","animation","appearance"].find(h=>d[h]&&(d[h].isFirstChange()||d[h].previousValue===d[h].currentValue))||this.validateInputValues()}ngAfterViewInit(){b("NgxSkeletonLoader:Rendered")}ngOnDestroy(){b("NgxSkeletonLoader:Loaded")}}return p.\u0275fac=function(d){return new(d||p)(r.Y36(M,8))},p.\u0275cmp=r.Xpm({type:p,selectors:[["ngx-skeleton-loader"]],inputs:{appearance:"appearance",animation:"animation",theme:"theme",loadingText:"loadingText",count:"count",ariaLabel:"ariaLabel"},features:[r.TTD],decls:1,vars:1,consts:[["class","loader","aria-busy","true","aria-valuemin","0","aria-valuemax","100","role","progressbar","tabindex","0",3,"ngClass","ngStyle",4,"ngFor","ngForOf"],["aria-busy","true","aria-valuemin","0","aria-valuemax","100","role","progressbar","tabindex","0",1,"loader",3,"ngClass","ngStyle"]],template:function(d,h){1&d&&r.YNc(0,D,1,9,"span",0),2&d&&r.Q6J("ngForOf",h.items)},dependencies:[x.mk,x.sg,x.PC],styles:['.loader[_ngcontent-%COMP%]{background:#eff1f6 no-repeat;border-radius:4px;box-sizing:border-box;display:inline-block;height:20px;margin-bottom:10px;overflow:hidden;position:relative;width:100%;will-change:transform}.loader[_ngcontent-%COMP%]:after, .loader[_ngcontent-%COMP%]:before{box-sizing:border-box}.loader.circle[_ngcontent-%COMP%]{border-radius:50%;height:40px;margin:5px;width:40px}.loader.progress[_ngcontent-%COMP%], .loader.progress-dark[_ngcontent-%COMP%]{transform:translateZ(0)}.loader.progress-dark[_ngcontent-%COMP%]:after, .loader.progress-dark[_ngcontent-%COMP%]:before, .loader.progress[_ngcontent-%COMP%]:after, .loader.progress[_ngcontent-%COMP%]:before{box-sizing:border-box}.loader.progress-dark[_ngcontent-%COMP%]:before, .loader.progress[_ngcontent-%COMP%]:before{-webkit-animation:progress 2s ease-in-out infinite;animation:progress 2s ease-in-out infinite;background-size:200px 100%;content:"";height:100%;left:0;position:absolute;top:0;width:200px;z-index:1}.loader.progress[_ngcontent-%COMP%]:before{background-image:linear-gradient(90deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.6),hsla(0,0%,100%,0))}.loader.progress-dark[_ngcontent-%COMP%]:before{background-image:linear-gradient(90deg,transparent,rgba(0,0,0,.2),transparent)}.loader.pulse[_ngcontent-%COMP%]{-webkit-animation:pulse 1.5s cubic-bezier(.4,0,.2,1) infinite;-webkit-animation-delay:.5s;animation:pulse 1.5s cubic-bezier(.4,0,.2,1) infinite;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.loader.progress[_ngcontent-%COMP%], .loader.progress-dark[_ngcontent-%COMP%], .loader.pulse[_ngcontent-%COMP%]{-webkit-animation:none;animation:none}.loader.progress[_ngcontent-%COMP%], .loader.progress-dark[_ngcontent-%COMP%]{background-image:none}}@-webkit-keyframes progress{0%{transform:translate3d(-200px,0,0)}to{transform:translate3d(calc(200px + 100vw),0,0)}}@keyframes progress{0%{transform:translate3d(-200px,0,0)}to{transform:translate3d(calc(200px + 100vw),0,0)}}@-webkit-keyframes pulse{0%{opacity:1}50%{opacity:.4}to{opacity:1}}@keyframes pulse{0%{opacity:1}50%{opacity:.4}to{opacity:1}}'],changeDetection:0}),p})(),T=(()=>{class p{static forRoot(d){return{ngModule:p,providers:[{provide:M,useValue:d}]}}}return p.\u0275fac=function(d){return new(d||p)},p.\u0275mod=r.oAB({type:p}),p.\u0275inj=r.cJS({imports:[x.ez]}),p})()}}]);