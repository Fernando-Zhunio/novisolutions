"use strict";(self.webpackChunkng=self.webpackChunkng||[]).push([[8837],{18837:(R,T,c)=>{c.r(T),c.d(T,{AuthenticateModule:()=>j});var h=c(69808),v=c(67322),f=c(9224),l=c(93075),p=c(59516),g=c(29724),t=c(5e3),w=c(8735),_=c(25245),A=c(77531),y=c(47423);function E(n,r){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Las Este campo es requerido"),t.qZA())}function J(n,r){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Las Este campo es requerido"),t.qZA())}let P=(()=>{class n{constructor(e,o,i){this.s_standard=e,this.active_router=o,this.router=i,this.hide=!0,this.hide2=!0,this.isLoad=!1,this.formPassword=new l.cw({password:new l.NI("",[l.kI.required]),password_confirmation:new l.NI("",[l.kI.required])})}ngOnInit(){this.token=this.active_router.snapshot.queryParams.token,this.token||this.router.navigate(["login"])}saveInServer(){let e=this.formPassword.value;e.token=this.token,this.formPassword.valid&&(this.isLoad=!0,this.s_standard.updatePut("user/first-password",e).subscribe(o=>{o.hasOwnProperty("success")&&o.success?this.router.navigate(["login"]):g.J.swalFire({text:"A ocurrido un error",icon:"error"}),this.isLoad=!1},()=>{g.J.swalFire({text:"A ocurrido un error",icon:"error"}),this.isLoad=!1}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w.X),t.Y36(p.gz),t.Y36(p.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-capture-password"]],decls:33,vars:12,consts:[[1,"pt-sm-0","pt-4","vh-100","bg-login",2,"background-image","url('assets/img/login.svg')","background-size","cover"],[1,"row","m-0","vh-100"],[1,"col-md-6","col-sm-12","d-flex","align-items-center","justify-content-center"],[1,"text-info"],[1,"",3,"formGroup","ngSubmit"],[1,""],["appearance","fill",1,"d-block"],["autocomplete","","matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[4,"ngIf"],["autocomplete","","matInput","","formControlName","password_confirmation",3,"type"],["color","primary","type","submit","mat-raised-button","",3,"disabled"],[1,"col-md-6","col-sm-12","d-flex","p-0","align-items-center"],["src","/assets/img/capture-password.svg","alt","",1,"w-100","position-absolute"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),t.NdJ("ngSubmit",function(){return o.saveInServer()}),t.TgZ(5,"mat-card",5)(6,"mat-card-header")(7,"mat-card-title"),t._uU(8,"ESTABLECER CONTRASE\xd1A SYSTEM"),t.qZA(),t.TgZ(9,"mat-card-subtitle"),t._uU(10,"Formulario de inicio de establecer contrase\xf1a de Novisolutions "),t.qZA()(),t.TgZ(11,"mat-card-content")(12,"mat-form-field",6)(13,"mat-label"),t._uU(14,"Contrase\xf1a"),t.qZA(),t._UZ(15,"input",7),t.TgZ(16,"button",8),t.NdJ("click",function(){return o.hide=!o.hide}),t.TgZ(17,"mat-icon"),t._uU(18),t.qZA()(),t.YNc(19,E,2,0,"mat-error",9),t.qZA(),t.TgZ(20,"mat-form-field",6)(21,"mat-label"),t._uU(22,"Confirmar contrase\xf1a"),t.qZA(),t._UZ(23,"input",10),t.TgZ(24,"button",8),t.NdJ("click",function(){return o.hide2=!o.hide2}),t.TgZ(25,"mat-icon"),t._uU(26),t.qZA()(),t.YNc(27,J,2,0,"mat-error",9),t.qZA()(),t.TgZ(28,"mat-card-actions")(29,"button",11),t._uU(30,"Iniciar sesion"),t.qZA()()()()()(),t.TgZ(31,"div",12),t._UZ(32,"img",13),t.qZA()()()),2&e){let i,s;t.xp6(4),t.Q6J("formGroup",o.formPassword),t.xp6(11),t.Q6J("type",o.hide?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",o.hide),t.xp6(2),t.Oqu(o.hide?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",null==(i=o.formPassword.get("password"))?null:i.invalid),t.xp6(4),t.Q6J("type",o.hide2?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",o.hide),t.xp6(2),t.Oqu(o.hide?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",null==(s=o.formPassword.get("password_confirmation"))?null:s.invalid),t.xp6(2),t.Q6J("disabled",o.formPassword.invalid||o.isLoad)}},dependencies:[h.O5,v.TO,v.KE,v.hX,v.R9,f.a8,f.dk,f.dn,f.n5,f.$j,f.hq,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,_.Hw,A.Nt,y.lW]}),n})();var b=c(68896),Z=c(24850),F=c(27221);let x=(()=>{class n{constructor(e,o){this.s_standard=e,this.route=o}resolve(e){return this.s_standard.show("user/authenticate?token="+e.queryParams.token).pipe((0,Z.U)(i=>i),(0,F.K)(i=>(console.log(i),this.route.navigate(["login"]),b.E)))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(w.X),t.LFG(p.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class I{}var L=c(23753),G=c(71188),C=c(86405);function O(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"span",2),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("innerHTML",e.i.text,t.oJD)}}function N(n,r){1&n&&t.GkF(0)}const Y=function(n){return{$implicit:n}};var d=(()=>{return(n=d||(d={}))[n.ing=0]="ing",n[n.pause=1]="pause",n[n.stop=2]="stop",n[n.done=3]="done",d;var n})();let k=(()=>{class n{constructor(e){this.ngZone=e,this.fns=[],this.commands=[],this.nextTime=0,this.ing=!1}start(){!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular(()=>{this.process()}))}process(){for(;this.commands.length;)this.commands.shift()();let e=+new Date-this.nextTime;const o=1+Math.floor(e/100);e=100-e%100,this.nextTime+=100*o;for(let i=0,s=this.fns.length;i<s;i+=2){let u=this.fns[i+1];if(0===u)this.fns[i](o);else{u+=2*o-1;const a=Math.floor(u/20);a>0&&this.fns[i](a),this.fns[i+1]=u%20+1}}!this.ing||setTimeout(()=>this.process(),e)}add(e,o){return this.commands.push(()=>{this.fns.push(e),this.fns.push(1e3===o?1:0),this.ing=!0}),this}remove(e){return this.commands.push(()=>{const o=this.fns.indexOf(e);-1!==o&&this.fns.splice(o,2),this.ing=this.fns.length>0}),this}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(t.R0b))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),M=(()=>{class n{constructor(e){this.locale=e,this.demand=!1,this.leftTime=0,this.format="HH:mm:ss",this.timezone="+0000",this.formatDate=({date:o,formatStr:i,timezone:s})=>(0,h.p6)(new Date(o),i,this.locale,s||this.timezone||"+0000")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(t.soG))},n.\u0275prov=t.Yz7({factory:function(){return new n(t.LFG(t.soG))},token:n,providedIn:"root"}),n})(),D=(()=>{class n{constructor(e,o,i,s,u){this.locale=e,this.timer=o,this.defCog=i,this.cdr=s,this.ngZone=u,this.frequency=1e3,this._notify={},this.status=d.ing,this.isDestroy=!1,this.i={},this.left=0,this.event=new t.vpe}set config(e){null!=e.notify&&!Array.isArray(e.notify)&&e.notify>0&&(e.notify=[e.notify]),this._config=e}get config(){return this._config}begin(){this.status=d.ing,this.callEvent("start")}restart(){this.status!==d.stop&&this.destroy(),this.init(),this.callEvent("restart")}stop(){this.status!==d.stop&&(this.status=d.stop,this.destroy(),this.callEvent("stop"))}pause(){this.status===d.stop||this.status===d.pause||(this.status=d.pause,this.callEvent("pause"))}resume(){this.status===d.stop||this.status!==d.pause||(this.status=d.ing,this.callEvent("resume"))}callEvent(e){this.event.emit({action:e,left:this.left,status:this.status,text:this.i.text})}init(){const{locale:e,defCog:o}=this,i=this.config=Object.assign(Object.assign(Object.assign({},new M(e)),o),this.config),s=this.frequency=~i.format.indexOf("S")?100:1e3;this.status=i.demand?d.pause:d.ing,this.getLeft();const u=this.reflow;this.reflow=(a=0,m=!1)=>u.apply(this,[a,m]),Array.isArray(i.notify)&&i.notify.forEach(a=>{if(a<1)throw new Error("The notify config must be a positive integer.");a*=1e3,this._notify[a-=a%s]=!0}),this.timer.add(this.reflow,s).start(),this.reflow(0,!0)}destroy(){return this.timer.remove(this.reflow),this}reflow(e=0,o=!1){if(this.isDestroy)return;const{status:i,config:s,_notify:u}=this;if(!o&&i!==d.ing)return;let a=this.left=this.left-this.frequency*e;a<1&&(a=0),this.i={value:a,text:s.formatDate({date:a,formatStr:s.format,timezone:s.timezone})},"function"==typeof s.prettyText&&(this.i.text=s.prettyText(this.i.text)),this.cdr.detectChanges(),(0===s.notify||u[a])&&this.ngZone.run(()=>{this.callEvent("notify")}),0===a&&this.ngZone.run(()=>{this.status=d.done,this.destroy(),this.callEvent("done")})}getLeft(){const{config:e,frequency:o}=this;let i=1e3*e.leftTime;const s=e.stopTime;!i&&s&&(i=s-(new Date).getTime()),this.left=i-i%o}ngOnInit(){this.init(),this.config.demand||this.begin()}ngOnDestroy(){this.isDestroy=!0,this.destroy()}ngOnChanges(e){e.config.firstChange||this.restart()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.soG),t.Y36(k),t.Y36(M),t.Y36(t.sBO),t.Y36(t.R0b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["countdown"]],hostVars:2,hostBindings:function(e,o){2&e&&t.ekj("count-down",!0)},inputs:{config:"config",render:"render"},outputs:{event:"event"},features:[t.TTD],decls:2,vars:5,consts:[[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"]],template:function(e,o){1&e&&(t.YNc(0,O,2,1,"ng-container",0),t.YNc(1,N,1,0,"ng-container",1)),2&e&&(t.Q6J("ngIf",!o.render),t.xp6(1),t.Q6J("ngTemplateOutlet",o.render)("ngTemplateOutletContext",t.VKq(3,Y,o.i)))},dependencies:[h.O5,h.tP],encapsulation:2,changeDetection:0}),n})(),q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[k],imports:[h.ez]}),n})();const U=["contentInput"];function S(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"input",16,17),t.NdJ("input",function(i){const u=t.CHM(e).index,a=t.MAs(1),m=t.oxw();return t.KtG(m.inputEvent(i,a,u))})("keydown",function(i){const u=t.CHM(e).index,a=t.MAs(1),m=t.oxw();return t.KtG(m.inputKeyDown(i,a,u))}),t.qZA()}}const z=[{path:"",component:(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-authetication"]],decls:1,vars:0,template:function(e,o){1&e&&t._UZ(0,"router-outlet")},dependencies:[p.lC],encapsulation:2}),n})(),children:[{path:"capture-password",component:P,canLoad:[x],resolve:{person:x}},{path:"codigo-confirmacion/:token",component:(()=>{class n{constructor(e,o,i,s,u){this.s_standart=e,this.active_router=o,this.router=i,this.s_storage=s,this.spinner=u,this.hide=!0,this.hide2=!0,this.isLoading=!1,this.formPassword=new l.cw({code:new l.NI("",[l.kI.required])}),this.config={format:"mm:ss",leftTime:10},this.CountInputs=6,this.inputsValue=[],this.eventPaste=(0,L.R)(document,"paste")}ngOnInit(){this.eventPaste.subscribe(()=>{navigator.clipboard?navigator.clipboard.readText().then(o=>{this.fillInputs(o)}):g.J.swalToast("Necesitas proporcionar permisos de portapapeles a esta pagina","warning")}),this.initializeInputs();const e=this.active_router.snapshot.data.response.data;this.user=e.user,this.token=e.token.token,this.config.leftTime=300-e.time_sub}fillInputs(e){let o=0;e.split("").forEach(i=>{const s=this.inputs.get(o);s&&(s.nativeElement.value=i),o++}),setTimeout(()=>{const i=this.inputs.get(5);i&&i.nativeElement.focus()},2e3)}initializeInputs(){this.inputsValue=[];for(let e=0;e<this.CountInputs;e++)this.inputsValue.push("")}handleEvent(e){"done"===e.action&&(g.J.swalToast("Tiempo agotado","warning"),this.router.navigate(["/login"]))}inputKeyDown(e,o,i){var s,u,a;console.log(this.inputs.get(i)),"Backspace"===e.key?""===o.value&&(0!=i?null===(s=this.inputs.get(i-1))||void 0===s||s.nativeElement.focus():o.value=""):"ArrowLeft"===e.key&&0!==i?null===(u=this.inputs.get(i-1))||void 0===u||u.nativeElement.focus():"ArrowRight"===e.key&&i!==this.inputs.length-1?null===(a=this.inputs.get(i+1))||void 0===a||a.nativeElement.focus():"ArrowLeft"!=e.key&&"ArrowRight"!=e.key&&"Enter"!=e.key&&(o.setAttribute("type","text"),o.value="")}inputEvent(e,o,i){var s;1===o.value.length&&i!==this.inputs.length-1&&(null===(s=this.inputs.get(i+1))||void 0===s||s.nativeElement.focus())}SaveInServer(){const e=this.getCodeTwoFactor();6===e.length?(this.isLoading=!0,this.s_standart.methodPost("auth/email-two-factor/"+this.token,{code:e}).subscribe(o=>{if(null!=o&&o.success){this.spinner.show("spinner-tf");const i=new I;i.token=o.data.access_token,i.expires_at=o.data.expires_at,i.token_type=o.data.token_type;const{id:s,name:u,email:a,person:m}=o.data.user;i.user={id:s,name:u,email:a,person:m},this.s_storage.setCurrentSession(i),this.router.navigate(["/home/inicio"])}else g.J.swalToast("Error  verifique su contrase\xf1a o email","warning");this.isLoading=!1},()=>{this.isLoading=!1})):g.J.swalToast("C\xf3digo incorrecto","warning")}getCodeTwoFactor(){let e="";return this.inputs.forEach(o=>{e+=o.nativeElement.value}),e}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w.X),t.Y36(p.gz),t.Y36(p.F0),t.Y36(G.V),t.Y36(C.t2))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-two-fa"]],viewQuery:function(e,o){if(1&e&&t.Gf(U,5),2&e){let i;t.iGM(i=t.CRH())&&(o.inputs=i)}},decls:28,vars:7,consts:[[1,"pt-sm-0","pt-4","vh-100","bg-login"],[1,"row","m-0","vh-100","main"],[1,"col-md-6","col-sm-12","d-flex","align-items-center","justify-content-center"],[1,"text-info"],[1,"",3,"formGroup","ngSubmit"],[1,"font-4xl"],[3,"href"],["maxLength","1","class","separator-input","formControlName","code",3,"input","keydown",4,"ngFor","ngForOf"],[1,"col-12","mt-3","font-2xl","font-facebook"],[1,"font-weight-bold","font-4xl",3,"config","event"],[1,"font-weight-normal"],["color","primary","type","submit","mat-raised-button","",3,"disabled"],[1,"col-md-6","col-sm-12","d-flex","p-0","align-items-center"],["src","/assets/img/capture-password.svg","alt","",1,"w-100","position-absolute"],["name","spinner-tf","bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","square-jelly-box",3,"fullScreen"],[2,"color","white"],["maxLength","1","formControlName","code",1,"separator-input",3,"input","keydown"],["contentInput",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),t.NdJ("ngSubmit",function(){return o.SaveInServer()}),t.TgZ(5,"mat-card")(6,"mat-card-header")(7,"mat-card-title",5),t._uU(8,"Autenticaci\xf3n de dos pasos"),t.qZA(),t.TgZ(9,"mat-card-subtitle"),t._uU(10,"Para ingresar a tu cuenta de forma segura ingresa el c\xf3digo enviado a tu mail "),t.TgZ(11,"a",6),t._uU(12),t.qZA()()(),t.TgZ(13,"mat-card-content")(14,"div"),t.YNc(15,S,2,0,"input",7),t.qZA(),t.TgZ(16,"div",8)(17,"countdown",9),t.NdJ("event",function(s){return o.handleEvent(s)}),t.qZA(),t.TgZ(18,"span",10),t._uU(19," Tiempo para ingresar el c\xf3digo "),t.qZA()()(),t.TgZ(20,"mat-card-actions")(21,"button",11),t._uU(22,"Iniciar sesi\xf3n"),t.qZA()()()()()(),t.TgZ(23,"div",12),t._UZ(24,"img",13),t.qZA(),t.TgZ(25,"ngx-spinner",14)(26,"p",15),t._uU(27," Cargando datos del usuario... "),t.qZA()()()()),2&e&&(t.xp6(4),t.Q6J("formGroup",o.formPassword),t.xp6(7),t.MGl("href","mailto:",null==o.user?null:o.user.email,"",t.LSH),t.xp6(1),t.hij('"',null==o.user?null:o.user.email,'"'),t.xp6(3),t.Q6J("ngForOf",o.inputsValue),t.xp6(2),t.Q6J("config",o.config),t.xp6(4),t.Q6J("disabled",o.formPassword.invalid||o.isLoading),t.xp6(4),t.Q6J("fullScreen",!0))},dependencies:[h.sg,f.a8,f.dk,f.dn,f.n5,f.$j,f.hq,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,y.lW,D,C.Ro],styles:[".bg-login[_ngcontent-%COMP%]{background-color:#fff}.main[_ngcontent-%COMP%]{background:linear-gradient(to right,#2196f3 0%,rgba(255,255,255,0) 69%)}.separator-input[_ngcontent-%COMP%]{height:90px;width:58px;border-radius:10px;margin-left:10px;display:inline-block;border:none;outline:none;border:2px solid skyblue;text-align:center;font-size:38px}"]}),n})(),resolve:{response:(()=>{class n{constructor(e,o){this.router=e,this.s_standart=o}resolve(e){return this.s_standart.show("auth/email-two-factor/"+e.params.token).pipe((0,Z.U)(i=>(null!=i&&i.success&&(e.queryParams={}),i)),(0,F.K)(i=>(console.log(i),this.router.navigate(["login"]),b.E)))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(p.F0),t.LFG(w.X))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()}}]}];let Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.Bz.forChild(z),p.Bz]}),n})(),j=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[Q,h.ez,v.lN,f.QW,l.UX,_.Ps,A.c,y.ot,q,C.ef]}),n})()}}]);