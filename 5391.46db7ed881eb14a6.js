"use strict";(self.webpackChunkng=self.webpackChunkng||[]).push([[5391],{85391:(q,h,i)=>{i.r(h),i.d(h,{ChatsModule:()=>L});var m=i(69808),l=i(59516),f=i(41571),b=i(29724),M=i(57062),e=i(5e3),G=i(8735),c=i(92081),p=i(93075),d=i(67322),_=i(77531),C=i(47423),g=i(14623),v=i(25245),x=i(9224),Z=i(77446);function A(n,o){1&n&&e._uU(0,"Seleccionador de usuarios")}function J(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-list-option",25),e.NdJ("click",function(){const r=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.addUser(r.key))}),e.TgZ(1,"div",26),e._UZ(2,"img",27),e._uU(3),e.qZA()()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("disabled",a.usersSelect.has(t.key))("value",t.key),e.xp6(2),e.Q6J("src",a.getPhoto(null==t.value||null==t.value.person||null==t.value.person.photo?null:t.value.person.photo.permalink),e.LSH),e.xp6(1),e.hij(" \xa0 ",null==t.value?null:t.value.name," ")}}function U(n,o){if(1&n&&(e.TgZ(0,"mat-selection-list",23),e.YNc(1,J,4,4,"mat-list-option",24),e.ALo(2,"keyvalue"),e.qZA()),2&n){const t=e.oxw();e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,2,t.users))}}function w(n,o){1&n&&(e.TgZ(0,"div",30)(1,"p",31),e._uU(2,"Sin datos de usuarios"),e.qZA(),e.TgZ(3,"div",32),e._UZ(4,"img",33),e.qZA()())}function y(n,o){1&n&&(e.TgZ(0,"p",34),e._uU(1," Cargando espere... "),e.qZA())}function S(n,o){if(1&n&&(e.YNc(0,w,5,0,"div",28),e.YNc(1,y,2,0,"p",29)),2&n){const t=e.oxw();e.Q6J("ngIf",t.users.size<=0&&!t.isLoading),e.xp6(1),e.Q6J("ngIf",t.isLoading)}}function I(n,o){1&n&&(e.TgZ(0,"div",35),e._uU(1,"Debe seleccionar por lo menos dos integrantes"),e.qZA())}function N(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-list-option",38)(1,"div",39)(2,"span"),e._UZ(3,"img",27),e._uU(4),e.qZA(),e.TgZ(5,"span")(6,"mat-checkbox",40),e.NdJ("ngModelChange",function(s){const u=e.CHM(t).$implicit;return e.KtG(u.value.isAdmin=s)}),e.TgZ(7,"small"),e._uU(8,"Hacer admin"),e.qZA()(),e.TgZ(9,"button",41),e.NdJ("click",function(){const r=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.removeUser(r.key))}),e.TgZ(10,"mat-icon"),e._uU(11,"close"),e.qZA()()()()()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("value",t.key),e.xp6(3),e.Q6J("src",a.getPhoto(null==t.value||null==t.value.person||null==t.value.person.photo?null:t.value.person.photo.permalink),e.LSH),e.xp6(1),e.hij(" \xa0 ",null==t.value?null:t.value.name," "),e.xp6(2),e.Q6J("ngModel",t.value.isAdmin)}}function k(n,o){if(1&n&&(e.TgZ(0,"mat-card",10)(1,"mat-selection-list",23),e.YNc(2,N,12,4,"mat-list-option",36),e.ALo(3,"keyvalue"),e.qZA(),e.TgZ(4,"div")(5,"button",37),e._uU(6,"Siguiente "),e.TgZ(7,"mat-icon"),e._uU(8,"arrow_forward"),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",e.lcZ(3,3,t.usersSelect)),e.xp6(3),e.Q6J("disabled",t.usersSelect.size<2)}}function Q(n,o){1&n&&e._uU(0,"Datos del Grupo")}function F(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.removeImg())}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA()()}}function O(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",42)(1,"span",43)(2,"label",44)(3,"span",45)(4,"mat-icon"),e._uU(5,"edit"),e.qZA()()(),e.TgZ(6,"input",46),e.NdJ("change",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.getBase64(s))}),e.qZA()(),e.YNc(7,F,3,0,"button",47),e._UZ(8,"img",48),e.qZA()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.img.file),e.xp6(1),e.Q6J("src",null==t.img?null:t.img.base64,e.LSH)}}let T=(()=>{class n extends M.${constructor(t,a,s){super(t,a,s),this.s_standard=a,this.users=new Map,this.usersSelect=new Map,this.isEditable=!1,this.page=1,this.searchText="",this.img={file:null,base64:"assets/img/user_group.png"},this.nameGroup="",this.isLoading=!1,this.urlSave="chats/groups",this.params="?page=&search=",this.title="Chat grupal - ",this.isFormParams=!0}ngOnInit(){this.init()}setData(t){if("edit"!=this.status)this.users=new Map(t.data.map(a=>[a.id,a]));else{const a=t.chat;this.nameGroup=a.name,this.img.base64=a.img;const s=t.participants;this.users=new Map(t.users.data.map(r=>[r.id,r])),this.usersSelect=new Map(s.map(r=>[r.id,Object.assign(Object.assign({},r),{isAdmin:a.admins.includes(r._id)})]))}}searchUser(){this.isLoading=!0,this.params="?page=&search="+this.searchText,this.standard_service.show(`${this.urlSave}/create${this.params}`).subscribe(t=>{this.users=new Map(t.data.data.map(s=>[s.id,s])),this.isLoading=!1},()=>{this.isLoading=!1})}addUser(t){if(!this.usersSelect.has(t)){const a=this.users.get(t);a.isAdmin=!1,this.usersSelect.set(t,a)}}removeUser(t){this.usersSelect.delete(t)}getPhoto(t){return f.F.rediredImageNull(t,"assets/img/user.png")}getBase64(t){this.img.file=t.target.files[0],this.img.base64=f.F.getBase64(t,this.callbackImg.bind(this))}removeImg(){this.img={file:null,base64:"assets/img/user_group.png"}}callbackImg(t){this.img.base64=t.srcElement.result}getDataForSendServer(){if(this.usersSelect.size<2||!this.nameGroup||this.nameGroup.length<3)return b.J.swalFire({icon:"error",text:"Faltan campos por llenar \n 1. Debe tener un minimo de dos usuarios para ser un chat grupal\n 2. Debe tener un nombre de grupo",position:"center"}),!1;{const t=new FormData;return t.append("name",this.nameGroup),this.usersSelect.forEach(a=>{t.append("participants[]",a.id),a.isAdmin&&t.append("admins[]",a.id)}),this.img.base64&&this.img.file&&t.append("img",this.img.file),t}}go(){this.router.navigate(["/home/inicio"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.gz),e.Y36(G.X),e.Y36(l.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-group-chat"]],features:[e.qOj],decls:38,vars:10,consts:[[1,"font-facebook","font-3xl","my-2"],["linear","",1,"rounded-fz"],["stepper",""],[3,"editable"],[1,"row"],["matStepLabel",""],[1,"col-md-6"],[1,"search-container"],["placeholder","Buscador de Usuario","name","search",1,"input-search",3,"ngModel","keydown.enter","ngModelChange"],["matSuffix","","mat-mini-fab","",1,"btn-search",3,"click"],[1,"rounded-fz","shadow"],[3,"multiple",4,"ngIf","ngIfElse"],["loaderTemplate",""],[1,"font-facebook","font-2xl"],["class","text-danger",4,"ngIf"],["class","rounded-fz shadow",4,"ngIf"],[1,"container","text-center"],["class","position-relative",4,"ngIf"],[1,"col-md-8","col-12"],["matInput","","placeholder","Ingrese el nombre del grupo","required","",3,"ngModel","ngModelChange"],[1,"my-2"],["mat-raised-button","","matStepperPrevious","","color","accent"],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"multiple"],[3,"disabled","value","click",4,"ngFor","ngForOf"],[3,"disabled","value","click"],[1,"d-flex","align-items-center"],[1,"photo-user",3,"src"],["class","text-center",4,"ngIf"],["class","parpadeo font-2xl p-3 text-muted",4,"ngIf"],[1,"text-center"],[1,"font-3xl","text-muted"],[1,"w-100"],["src","assets/img/respuesta_vacia.svg","alt","",1,"w-50"],[1,"parpadeo","font-2xl","p-3","text-muted"],[1,"text-danger"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","matStepperNext","","color","primary",1,"my-2",3,"disabled"],[3,"value"],[1,"d-flex","align-items-center","justify-content-between"],["color","primary",3,"ngModel","ngModelChange"],["color","warn","mat-icon-button","",3,"click"],[1,"position-relative"],[1,"file-img"],["for","file"],[1,"btn-primary","rounded-circle","p-2","center"],["id","file","type","file","name","file",1,"d-none",3,"change"],["class","position-absolute","color","warn","mat-icon-button","",3,"click",4,"ngIf"],[1,"img","rounded-circle",3,"src"],["color","warn","mat-icon-button","",1,"position-absolute",3,"click"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div")(1,"div")(2,"h2",0),e._uU(3),e.qZA()(),e.TgZ(4,"mat-horizontal-stepper",1,2)(6,"mat-step",3)(7,"div",4),e.YNc(8,A,1,0,"ng-template",5),e.TgZ(9,"div",6)(10,"div",7)(11,"input",8),e.NdJ("keydown.enter",function(){return a.searchUser()})("ngModelChange",function(r){return a.searchText=r}),e.qZA(),e.TgZ(12,"button",9),e.NdJ("click",function(){return a.searchUser()}),e.TgZ(13,"mat-icon"),e._uU(14,"search"),e.qZA()()(),e.TgZ(15,"mat-card",10),e.YNc(16,U,3,4,"mat-selection-list",11),e.YNc(17,S,2,2,"ng-template",null,12,e.W1O),e.qZA()(),e.TgZ(19,"div",6)(20,"h2",13),e._uU(21,"Usuarios seleccionados"),e.qZA(),e.YNc(22,I,2,0,"div",14),e.YNc(23,k,9,5,"mat-card",15),e.qZA()()(),e.TgZ(24,"mat-step"),e.YNc(25,Q,1,0,"ng-template",5),e.TgZ(26,"div",16)(27,"div"),e.YNc(28,O,9,2,"div",17),e.qZA(),e.TgZ(29,"mat-form-field",18)(30,"input",19),e.NdJ("ngModelChange",function(r){return a.nameGroup=r}),e.qZA()()(),e.TgZ(31,"div",20)(32,"button",21)(33,"mat-icon"),e._uU(34,"arrow_back"),e.qZA(),e._uU(35," Atras "),e.qZA(),e.TgZ(36,"button",22),e.NdJ("click",function(){return a.saveInServer()}),e._uU(37,"Guardar"),e.qZA()()()()()),2&t){const s=e.MAs(18);e.xp6(3),e.Oqu(a.title),e.xp6(3),e.Q6J("editable",!0),e.xp6(5),e.Q6J("ngModel",a.searchText),e.xp6(5),e.Q6J("ngIf",!a.isLoading&&a.users.size>0)("ngIfElse",s),e.xp6(6),e.Q6J("ngIf",a.usersSelect.size<2),e.xp6(1),e.Q6J("ngIf",a.usersSelect.size>0),e.xp6(5),e.Q6J("ngIf",null==a.img?null:a.img.base64),e.xp6(2),e.Q6J("ngModel",a.nameGroup),e.xp6(6),e.Q6J("disabled",a.isLoading)}},dependencies:[m.sg,m.O5,c.C0,c.VY,c.Vq,c.Ic,c.fd,p.Fj,p.JJ,p.Q7,p.On,d.KE,d.R9,_.Nt,C.lW,g.Ub,g.vS,v.Hw,x.a8,Z.oG,m.Nd],styles:[".photo-user[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%}.input-search[_ngcontent-%COMP%]{border:none;box-shadow:0 0 6px #dadada;padding:11px;margin:10px;border:2px solid;width:100%;border-radius:22px}.img[_ngcontent-%COMP%]{width:300px;height:300px;object-fit:contain}.btn-search[_ngcontent-%COMP%]{position:absolute;top:13px;right:13px}.search-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:flex-end;width:100%}.file-img[_ngcontent-%COMP%]{position:absolute;left:59%;top:15%}"]}),n})();const Y=[{path:"grupal",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-as-users"]],decls:1,vars:0,template:function(t,a){1&t&&e._UZ(0,"router-outlet")},dependencies:[l.lC],encapsulation:2}),n})(),children:[{path:"create",component:T,data:{isEdit:!1}},{path:":id/edit",component:T,data:{isEdit:!0}}]}];let z=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[l.Bz.forChild(Y),l.Bz]}),n})(),L=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.ez,z,l.Bz,c.T5,p.UX,p.u5,d.lN,_.c,C.ot,g.ie,v.Ps,x.QW,Z.p9]}),n})()}}]);