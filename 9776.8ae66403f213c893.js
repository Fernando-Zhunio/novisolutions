"use strict";(self.webpackChunkng=self.webpackChunkng||[]).push([[9776],{29776:(z,C,n)=>{n.r(C),n.d(C,{ChatBotsModule:()=>$});var u=n(69808),l=n(59516),b=n(4721),s=n(93075),k=n(57062),O=n(41571),B=n(29724),t=n(5e3),Z=n(8735),d=n(9224),m=n(47423),h=n(25245),f=n(67322),v=n(77531);function q(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.removeImg())}),t.TgZ(1,"mat-icon",15),t._uU(2,"delete"),t.qZA()()}}let x=(()=>{class o extends k.${constructor(e,a,i){super(e,a,i),this.title="Chatbot",this.isFormParams=!0,this.key_param="chatbot_id",this.form=new s.cw({name:new s.NI(null,s.kI.required)}),this.img={file:null,base64:"assets/img/img_not_available.png"},this.urlSave="admin/chatbot"}ngOnInit(){this.init()}getBase64(e){this.img.file=e.target.files[0],this.img.base64=O.F.getBase64(e,this.callbackImg.bind(this))}callbackImg(e){this.img.base64=e.srcElement.result}removeImg(){this.img={file:null,base64:"assets/img/img_not_available.png"}}getDataForSendServer(){var e;let a=new FormData;return this.form.valid?(this.img.base64&&this.img.file&&a.append("photo",this.img.file),a.append("name",null===(e=this.form.get("name"))||void 0===e?void 0:e.value),a.append("_method","PUT"),a):(B.J.swalToast("Faltan datos por llenar","error"),!1)}go(){this.router.navigate(["administracion-sistema/chatbot"])}setData(e){var a;console.log({data:e}),"edit"===this.status&&(null===(a=this.form.get("name"))||void 0===a||a.setValue(e.info.name),this.img.base64=e.info.photo||"assets/img/img_not_available.png")}saveInServer(){const e=this.getDataForSendServer();if(e){this.isLoading=!0;let i,a=this.urlSave;return"edit"===this.status?(a+=`/${this.getId()}`,i=this.standard_service.methodPost(a,e)):i=this.standard_service.methodPost(a,e),void i.subscribe(()=>{this.isLoading=!1,this.go()},c=>{console.log(c),this.isLoading=!1})}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.gz),t.Y36(Z.X),t.Y36(l.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-chat-bots-create-or-edit"]],features:[t.qOj],decls:22,vars:4,consts:[[1,"mt-3","font-4xl"],[1,"rounded-fz","shadow"],[1,"row","m-0",3,"formGroup"],[1,"col-12","position-relative"],[1,"img-bot","position-relative","m-auto"],["for","photo",1,"position-absolute"],[1,"btn-edit"],["mat-icon-button","","type","button","class","btn-remove",3,"click",4,"ngIf"],["type","file","name","photo","id","photo",1,"d-none",3,"change"],["alt","imagen chatbot",1,"w-100",3,"src"],[1,"col-12","center"],[1,"w-100"],["matInput","","placeholder","Escribe el nombre al chatbot","formControlName","name"],["color","primary","mat-raised-button","",3,"click"],["mat-icon-button","","type","button",1,"btn-remove",3,"click"],["color","warn"]],template:function(e,a){1&e&&(t.TgZ(0,"div")(1,"div")(2,"h1",0),t._uU(3),t.qZA()(),t.TgZ(4,"mat-card",1)(5,"mat-card-content")(6,"form",2)(7,"div",3)(8,"div",4)(9,"label",5)(10,"mat-icon",6),t._uU(11,"edit"),t.qZA()(),t.YNc(12,q,3,0,"button",7),t.TgZ(13,"input",8),t.NdJ("change",function(c){return a.getBase64(c)}),t.qZA(),t._UZ(14,"img",9),t.qZA()(),t.TgZ(15,"div",10)(16,"mat-form-field",11),t._UZ(17,"input",12),t.qZA()(),t.TgZ(18,"button",13),t.NdJ("click",function(){return a.saveInServer()}),t._uU(19,"Guardar "),t.TgZ(20,"mat-icon"),t._uU(21,"save"),t.qZA()()()()()()),2&e&&(t.xp6(3),t.Oqu(a.title),t.xp6(3),t.Q6J("formGroup",a.form),t.xp6(6),t.Q6J("ngIf",a.img.file),t.xp6(2),t.Q6J("src",a.img.base64,t.LSH))},dependencies:[u.O5,d.a8,d.dn,m.lW,h.Hw,f.KE,v.Nt,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:[".img-bot[_ngcontent-%COMP%]{max-width:200px;max-height:200px}.btn-remove[_ngcontent-%COMP%]{right:10px;position:absolute}.btn-edit[_ngcontent-%COMP%]{left:10px;width:40px;height:40px;cursor:pointer}"]}),o})();var T=n(98078),y=n(95625),w=n(57261),J=n(69287),A=n(28300),p=n(26688);const I=function(o){return["/administracion-sistema/chatbot/",o,"edit"]},F=function(o){return["./",o,"webhooks"]},E=function(o){return{name:o}};function L(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card",6)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5),t.qZA()(),t._UZ(6,"img",7),t.TgZ(7,"mat-card-content")(8,"mat-chip-list")(9,"mat-chip"),t._uU(10),t.qZA(),t.TgZ(11,"mat-chip"),t._uU(12),t.qZA()(),t.TgZ(13,"div",8),t.NdJ("click",function(){const c=t.CHM(e).$implicit,g=t.oxw();return t.KtG(g.copyToken(null==c.value?null:c.value.api_token))}),t._uU(14,"Token: "),t.TgZ(15,"span"),t._uU(16),t._UZ(17,"i",9),t.qZA()()(),t.TgZ(18,"mat-card-actions",10)(19,"button",11)(20,"mat-icon"),t._uU(21,"edit"),t.qZA()(),t.TgZ(22,"button",12),t.NdJ("click",function(){const c=t.CHM(e).$implicit,g=t.oxw();return t.KtG(g.deleteData(c.key))}),t.TgZ(23,"mat-icon"),t._uU(24,"delete"),t.qZA()(),t.TgZ(25,"button",13)(26,"mat-icon"),t._uU(27,"webhook"),t.qZA()()()()}if(2&o){const e=r.$implicit;t.xp6(3),t.Oqu(null==e.value||null==e.value.info?null:e.value.info.name),t.xp6(2),t.Oqu(null==e.value?null:e.value.status),t.xp6(1),t.Q6J("src",(null==e.value||null==e.value.info?null:e.value.info.photo)||"assets/img/img_not_available.png",t.LSH),t.xp6(4),t.hij("Id chat: ",null==e.value?null:e.value._id,""),t.xp6(2),t.hij("Tipo: ",null==e.value?null:e.value.type,""),t.xp6(4),t.hij("",null==e.value?null:e.value.api_token,"\xa0"),t.xp6(3),t.Q6J("routerLink",t.VKq(9,I,e.key)),t.xp6(6),t.Q6J("routerLink",t.VKq(11,F,e.key))("queryParams",t.VKq(13,E,e.value.info.name))}}const M=function(){return["./create"]};let Q=(()=>{class o extends T.r{constructor(e,a,i){super(),this.methodsHttp=e,this.snackBar=a,this.clipboard=i,this.url="admin/chatbot"}ngOnInit(){}getData(e){console.log(e),this.data=new Map(e.map(a=>[a._id,a]))}copyToken(e){return this.clipboard.copy(e),this.snackBar.open("Codigo copiado","OK",{duration:2e3}),e}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(y.s),t.Y36(w.ux),t.Y36(J.TU))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-chat-bots-index"]],features:[t.qOj],decls:12,vars:6,consts:[["title","Chatbots",3,"url$","data"],["menuBar",""],[1,"ml-1"],[1,"mat-btn-add",3,"routerLink"],["data",""],["class","card rounded-fz border-0 shadow",4,"ngFor","ngForOf"],[1,"card","rounded-fz","border-0","shadow"],["matCardImage","",3,"src"],[1,"mt-2","p-3","rounded-fz","shadow","bg-dark","cursor-pointer","pulso",3,"click"],[1,"far","fa-copy"],["align","start"],["mat-mini-fab","","routerLinkActive","router-link-active",3,"routerLink"],["mat-mini-fab","","color","warn",3,"click"],["mat-mini-fab","","color","primary",3,"routerLink","queryParams"]],template:function(e,a){1&e&&(t.TgZ(0,"div")(1,"div")(2,"app-search-template",0),t.NdJ("data",function(c){return a.getData(c)}),t.ynx(3,1),t.TgZ(4,"mat-chip-list",2)(5,"mat-chip",3)(6,"mat-icon"),t._uU(7,"smart_toy"),t.qZA(),t._uU(8,"\xa0Agregar Chatbot "),t.qZA()(),t.BQk(),t.ynx(9,4),t.YNc(10,L,28,15,"mat-card",5),t.ALo(11,"keyvalue"),t.BQk(),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("url$",a.url),t.xp6(3),t.Q6J("routerLink",t.DdM(5,M)),t.xp6(5),t.Q6J("ngForOf",t.lcZ(11,3,a.data)))},dependencies:[u.sg,l.rH,l.Od,A._,d.a8,d.dk,d.dn,d.n5,d.$j,d.hq,d.G2,m.lW,p.qn,p.HS,h.Hw,u.Nd]}),o})(),U=(()=>{class o extends k.${constructor(e,a,i,c){super(e,a,i),this.act_router=e,this.standard_service=a,this.router=i,this.location=c,this.form=new s.cw({endpoint:new s.NI(null,s.kI.required)}),this.title="Webhook - ",this.key_param="webhook_id",this.urlSave=`admin/chatbot/${this.getId("chatbot_id")}/webhooks`}ngOnInit(){this.init()}setData(e){e&&this.form.patchValue({endpoint:e.endpoint})}getDataForSendServer(){var e;return!!this.form.valid&&{url:null===(e=this.form.get("endpoint"))||void 0===e?void 0:e.value}}go(){this.location.back()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.gz),t.Y36(Z.X),t.Y36(l.F0),t.Y36(u.Ye))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-or-edit-chatbot-webhook"]],features:[t.qOj],decls:12,vars:3,consts:[[1,"m-0","mt-3","font-4xl"],[1,"rounded-fz","border-0","shadow","mt-4"],[3,"formGroup"],[1,"w-100"],["matInput","","placeholder","Escriba el url","formControlName","endpoint"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,a){1&e&&(t.TgZ(0,"div")(1,"div")(2,"h1",0),t._uU(3),t.qZA()(),t.TgZ(4,"mat-card",1)(5,"form",2)(6,"mat-form-field",3),t._UZ(7,"input",4),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){return a.saveInServer()}),t._uU(9,"Guardar "),t.TgZ(10,"mat-icon"),t._uU(11,"save"),t.qZA()()()()()),2&e&&(t.xp6(3),t.hij(" ",a.title,""),t.xp6(2),t.Q6J("formGroup",a.form),t.xp6(3),t.Q6J("disabled",a.isLoading))},dependencies:[d.a8,m.lW,h.Hw,f.KE,v.Nt,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u]}),o})();const D=function(o){return["./",o,"edit"]};function N(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card",6)(1,"mat-card-content")(2,"div",7)(3,"div"),t._uU(4,"_id: "),t.TgZ(5,"span"),t._uU(6),t.qZA()(),t.TgZ(7,"div"),t._uU(8,"Endpoint: "),t.TgZ(9,"span"),t._uU(10),t.qZA()(),t.TgZ(11,"div"),t._uU(12,"Usuario id: "),t.TgZ(13,"span"),t._uU(14),t.qZA()(),t.TgZ(15,"div"),t._uU(16,"Creado: "),t.TgZ(17,"span"),t._uU(18),t.ALo(19,"date"),t.qZA()(),t.TgZ(20,"div"),t._uU(21,"Modificado: "),t.TgZ(22,"span"),t._uU(23),t.ALo(24,"date"),t.qZA()()(),t.TgZ(25,"div")(26,"button",8)(27,"mat-icon"),t._uU(28,"edit"),t.qZA()(),t.TgZ(29,"button",9),t.NdJ("click",function(){const c=t.CHM(e).$implicit,g=t.oxw();return t.KtG(g.deleteData(c.key))}),t.TgZ(30,"mat-icon"),t._uU(31,"delete"),t.qZA()()()()()}if(2&o){const e=r.$implicit;t.xp6(6),t.Oqu(e.value._id),t.xp6(4),t.Oqu(e.value.endpoint),t.xp6(4),t.Oqu(e.value.user_id),t.xp6(4),t.Oqu(t.lcZ(19,6,e.value.created_at)),t.xp6(5),t.Oqu(t.lcZ(24,8,e.value.updated_at)),t.xp6(3),t.Q6J("routerLink",t.VKq(10,D,e.key))}}const W=function(){return["./create"]},_={chatbot:{index:["super-admin","admin.chatbot.index"],show:["super-admin","admin.chatbot.show"],create:["super-admin","admin.chatbot.create"],edit:["super-admin","admin.chatbot.edit"],delete:["super-admin","admin.chatbot.destroy"]},chatbot_webhook:{index:["super-admin","admin.chatbot_webhook.index"],show:["super-admin","admin.chatbot_webhook.show"],create:["super-admin","admin.chatbot_webhook.create"],edit:["super-admin","admin.chatbot_webhook.edit"],delete:["super-admin","admin.chatbot_webhook.destroy"]}},S=[{path:"",component:Q,data:{permissions:{only:_.chatbot.index}},canActivate:[b.DD]},{path:"create",component:x,data:{permissions:{only:_.chatbot.create}},canActivate:[b.DD]},{path:":chatbot_id/edit",component:x,data:{isEdit:!0,permissions:{only:_.chatbot.edit}},canActivate:[b.DD]},{path:":chatbot_id/webhooks",children:[{path:"",component:(()=>{class o extends T.r{constructor(e,a,i){super(),this.activated_route=e,this.methodsHttp=a,this.snackBar=i,this.title="Webhooks",this.url=`admin/chatbot/${this.getParam("chatbot_id")}/webhooks`,this.title=this.getQueryParams("name")}ngOnInit(){}getParam(e){return this.activated_route.snapshot.paramMap.get(e)}getQueryParams(e){return this.activated_route.snapshot.queryParamMap.get(e)}getData(e){console.log(e),this.data=new Map(e.map(a=>[a._id,a]))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.gz),t.Y36(y.s),t.Y36(w.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-webhooks"]],features:[t.qOj],decls:12,vars:6,consts:[["title","Webhook",3,"url$","data"],["menuBar",""],[1,"ml-1"],[1,"mat-btn-add",3,"routerLink"],["data",""],["class","card shadow rounded-fz border-0",4,"ngFor","ngForOf"],[1,"card","shadow","rounded-fz","border-0"],[1,"card-body","item-webhook","font-lg"],["mat-mini-fab","","routerLinkActive","router-link-active","color","primary",3,"routerLink"],["mat-mini-fab","","color","warn",3,"click"]],template:function(e,a){1&e&&(t.TgZ(0,"div")(1,"div")(2,"app-search-template",0),t.NdJ("data",function(c){return a.getData(c)}),t.ynx(3,1),t.TgZ(4,"mat-chip-list",2)(5,"mat-chip",3)(6,"mat-icon"),t._uU(7,"webhook"),t.qZA(),t._uU(8,"\xa0 Agregar Webhook "),t.qZA()(),t.BQk(),t.ynx(9,4),t.YNc(10,N,32,12,"mat-card",5),t.ALo(11,"keyvalue"),t.BQk(),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("url$",a.url),t.xp6(3),t.Q6J("routerLink",t.DdM(5,W)),t.xp6(5),t.Q6J("ngForOf",t.lcZ(11,3,a.data)))},dependencies:[u.sg,l.rH,l.Od,A._,d.a8,d.dn,m.lW,p.qn,p.HS,h.Hw,u.uU,u.Nd],styles:[".item-webhook[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6495ed;line-height:1.2;font-style:italic}"]}),o})()},{path:"create",component:U},{path:":webhook_id/edit",component:U,data:{isEdit:!0}}]}];let H=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.Bz.forChild(S),l.Bz]}),o})();var P=n(75401);let $=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,l.Bz,H,P.r,d.QW,m.ot,p.Hi,h.Ps,f.lN,v.c,s.UX]}),o})()}}]);