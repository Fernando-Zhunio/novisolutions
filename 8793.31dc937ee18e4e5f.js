"use strict";(self.webpackChunkng=self.webpackChunkng||[]).push([[8793],{8793:(R,Z,s)=>{s.r(Z),s.d(Z,{ProductoModule:()=>M});var l=s(69808),u=s(59516),m=s(4721),n=s(93075),p=s(29724),t=s(5e3),b=s(29531),d=s(67322),f=s(77531),C=s(74107),x=s(90508),q=s(25245),g=s(47423),_=s(9224);function P(r,a){1&r&&(t.TgZ(0,"mat-error"),t._uU(1,"Nombre Requerido"),t.qZA())}function y(r,a){if(1&r&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&r){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function O(r,a){1&r&&(t.TgZ(0,"mat-error"),t._uU(1,"Categor\xeda Requerida"),t.qZA())}function A(r,a){if(1&r&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&r){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.type)}}function N(r,a){1&r&&(t.TgZ(0,"mat-error"),t._uU(1,"Prefijo Requerido"),t.qZA())}function U(r,a){if(1&r&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&r){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function v(r,a){1&r&&(t.TgZ(0,"mat-error"),t._uU(1,"Marca Requerida"),t.qZA())}function I(r,a){1&r&&(t.ynx(0),t._uU(1," predefinida "),t.BQk())}function E(r,a){1&r&&(t.TgZ(0,"mat-form-field",25)(1,"mat-label"),t._uU(2,"C\xf3digo"),t.qZA(),t._UZ(3,"input",26),t.qZA())}let T=(()=>{class r{constructor(e,o,i){this.location=e,this.s_products=o,this.act_router=i,this.formCreateOrEdit=new n.cw({name:new n.NI(null,[n.kI.required,n.kI.max(200)]),code_old:new n.NI(null,[n.kI.max(200)]),code_alt:new n.NI(null,[n.kI.max(200)]),description:new n.NI(null,[n.kI.max(200)]),prefix:new n.NI(null,[n.kI.required,n.kI.max(200)]),category:new n.NI(null,[n.kI.required,n.kI.max(200)]),brand:new n.NI(null,[n.kI.required,n.kI.max(200)]),sequence:new n.NI(null),special_code:new n.NI(null,[n.kI.max(200)]),code:new n.NI({value:null,disabled:!0})}),this.isSend=!1,this.title="",this.categories=[],this.brands=[],this.prefixes=[],this.product_name="",this.id=null}ngOnInit(){this.act_router.data.subscribe(e=>{e.isEdit?(this.title="Editando Producto",this.id=this.act_router.snapshot.paramMap.get("id"),this.s_products.edit(this.id).subscribe(o=>{this.updateVariants(o.categories,o.brands,o.prefixes),this.product_name=o.product.name,this.formCreateOrEdit.controls.name.setValue(o.product.name),this.formCreateOrEdit.controls.code_old.setValue(o.product.old_code),this.formCreateOrEdit.controls.code_alt.setValue(o.product.code_alt),this.formCreateOrEdit.controls.description.setValue(o.product.description),this.formCreateOrEdit.controls.prefix.setValue(o.product.prefix_id),this.formCreateOrEdit.controls.category.setValue(o.product.category_id),this.formCreateOrEdit.controls.brand.setValue(o.product.brand_id),this.formCreateOrEdit.controls.code.setValue(o.product.code),this.formCreateOrEdit.controls.sequence.setValue(o.product.sequence.sequence_number)})):(this.title="Creando Producto",this.id=null,this.s_products.create().subscribe(o=>{this.updateVariants(o.categories,o.brands,o.prefixes)}))})}updateVariants(e,o,i){this.categories=e,this.brands=o,this.prefixes=i}sendData(){this.formCreateOrEdit.valid&&(this.isSend=!this.isSend,this.id?this.s_products.update(this.id,this.formCreateOrEdit.value).subscribe(e=>{e.hasOwnProperty("success")&&e.success?p.J.swalToast(e.message,"success"):p.J.swalToast(e.errors,"warning"),this.isSend=!this.isSend},e=>{console.log({error:e}),this.isSend=!this.isSend}):this.s_products.store(this.formCreateOrEdit.value).subscribe(e=>{e.hasOwnProperty("success")&&e.success?p.J.swalToast("Producto creado con exito","success"):p.J.swalToast(e.errors,"warning"),this.isSend=!this.isSend},e=>{console.log({error:e}),this.isSend=!this.isSend}))}goBack(){this.location.back()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(l.Ye),t.Y36(b.s),t.Y36(u.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-product-create-or-edit"]],decls:66,vars:13,consts:[[1,"mt-3","pb-3"],[1,"d-flex","justify-content-between"],[1,"font-4xl","font-weight-bold"],[1,"text-info",2,"line-height","1"],["mat-mini-fab","",1,"mb-2",3,"click"],[3,"formGroup","ngSubmit"],[1,"card-body"],[1,"d-block"],["matInput","","placeholder"," Escriba el nombre del producto","type","text","formControlName","name","required",""],[4,"ngIf"],[1,"row"],[1,"col-sm-12","col-md-4"],["matInput","","placeholder","Escriba el Codigo antiguo","type","text","formControlName","code_old"],["matInput","","placeholder","Escriba el Codigo alternativo","type","text","formControlName","code_alt"],["formControlName","category","required",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4","col-sm-12"],["formControlName","prefix","required",""],["formControlName","brand","required",""],["formControlName","description","type","text","rows","3","matInput","","placeholder","Escriba la descripcion"],["matInput","","placeholder","Escriba la Secuencia predefinida","type","text","formControlName","sequence"],["matInput","","placeholder"," Escriba el Codigo predefinido","type","text","formControlName","special_code"],["class","d-block mt-4",4,"ngIf"],["type","submit","mat-raised-button","","color","primary",1,"mt-3",3,"disabled"],[3,"value"],[1,"d-block","mt-4"],["matInput","","placeholder","","formControlName","code"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.TgZ(4,"span",3),t._uU(5),t.qZA()(),t.TgZ(6,"button",4),t.NdJ("click",function(){return o.goBack()}),t.TgZ(7,"mat-icon"),t._uU(8,"keyboard_return"),t.qZA()()(),t.TgZ(9,"form",5),t.NdJ("ngSubmit",function(){return o.sendData()}),t.TgZ(10,"mat-card")(11,"div",6)(12,"mat-form-field",7)(13,"mat-label"),t._uU(14,"Nombre del producto"),t.qZA(),t._UZ(15,"input",8),t.YNc(16,P,2,0,"mat-error",9),t.qZA(),t.TgZ(17,"div",10)(18,"mat-form-field",11)(19,"mat-label"),t._uU(20,"Codigo antiguo"),t.qZA(),t._UZ(21,"input",12),t.qZA(),t.TgZ(22,"mat-form-field",11)(23,"mat-label"),t._uU(24,"Codigo alternativo"),t.qZA(),t._UZ(25,"input",13),t.qZA(),t.TgZ(26,"mat-form-field",11)(27,"mat-label"),t._uU(28,"Seleccione una Categor\xeda"),t.qZA(),t.TgZ(29,"mat-select",14),t.YNc(30,y,2,2,"mat-option",15),t.qZA(),t.YNc(31,O,2,0,"mat-error",9),t.qZA(),t.TgZ(32,"mat-form-field",16)(33,"mat-label"),t._uU(34,"Seleccione una prefijo"),t.qZA(),t.TgZ(35,"mat-select",17),t.YNc(36,A,2,2,"mat-option",15),t.qZA(),t.YNc(37,N,2,0,"mat-error",9),t.qZA(),t.TgZ(38,"mat-form-field",16)(39,"mat-label"),t._uU(40,"Seleccione una Marca"),t.qZA(),t.TgZ(41,"mat-select",18),t.YNc(42,U,2,2,"mat-option",15),t.qZA(),t.YNc(43,v,2,0,"mat-error",9),t.qZA()(),t.TgZ(44,"mat-form-field",7)(45,"mat-label"),t._uU(46,"Descripci\xf3n"),t.qZA(),t._UZ(47,"textarea",19),t.qZA(),t.TgZ(48,"mat-form-field",7)(49,"mat-label"),t._uU(50,"Secuencia "),t.YNc(51,I,2,0,"ng-container",9),t.qZA(),t._UZ(52,"input",20),t.TgZ(53,"mat-hint"),t._uU(54,"Secuencia predefinida: (Colocar solo en caso de que se requiera una secuencia especifica, esto modificara las secuencias siguientes)"),t.qZA()(),t.TgZ(55,"mat-form-field",7)(56,"mat-label"),t._uU(57,"Codigo predefinido"),t.qZA(),t._UZ(58,"input",21),t.TgZ(59,"mat-hint"),t._uU(60,"C\xf3digo Predefinido: (Colocar en el caso que se requiera un c\xf3digo especial)"),t.qZA()(),t.YNc(61,E,4,0,"mat-form-field",22),t.TgZ(62,"button",23),t._uU(63,"Enviar "),t.TgZ(64,"mat-icon"),t._uU(65,"send"),t.qZA()()()()()()),2&e&&(t.xp6(3),t.hij("",o.title," "),t.xp6(2),t.Oqu(o.product_name),t.xp6(4),t.Q6J("formGroup",o.formCreateOrEdit),t.xp6(7),t.Q6J("ngIf",o.formCreateOrEdit.controls.name.invalid),t.xp6(14),t.Q6J("ngForOf",o.categories),t.xp6(1),t.Q6J("ngIf",o.formCreateOrEdit.controls.category.invalid),t.xp6(5),t.Q6J("ngForOf",o.prefixes),t.xp6(1),t.Q6J("ngIf",o.formCreateOrEdit.controls.prefix.invalid),t.xp6(5),t.Q6J("ngForOf",o.brands),t.xp6(1),t.Q6J("ngIf",o.formCreateOrEdit.controls.brand.invalid),t.xp6(8),t.Q6J("ngIf",!o.id),t.xp6(10),t.Q6J("ngIf",o.id),t.xp6(1),t.Q6J("disabled",o.formCreateOrEdit.invalid||o.isSend))},dependencies:[l.sg,l.O5,n._Y,n.Fj,n.JJ,n.JL,n.Q7,n.sg,n.u,d.TO,d.KE,d.bx,d.hX,f.Nt,C.gD,x.ey,q.Hw,g.lW,_.a8]}),r})();var w=s(8735),h=s(54945);function k(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.goCreate())}),t._uU(1,"Crear Producto"),t.qZA()}}const J=function(r){return["edit",r]};function S(r,a){if(1&r&&(t.TgZ(0,"span",25),t._UZ(1,"i",26),t.qZA()),2&r){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,J,e.id))}}function Q(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"span",27),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,c=t.oxw();return t.KtG(c.destroyProduct(i.id))}),t._UZ(1,"i",28),t.qZA()}}function F(r,a){if(1&r&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",21),t._uU(8),t.qZA(),t.TgZ(9,"td",21),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA(),t.TgZ(19,"td",22),t.YNc(20,S,2,3,"span",23),t.YNc(21,Q,2,0,"span",24),t.qZA()()),2&r){const e=a.$implicit,o=t.oxw();t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(e.code),t.xp6(2),t.Oqu(e.code_alt),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.description),t.xp6(2),t.Oqu(null==e.prefix?null:e.prefix.type),t.xp6(2),t.Oqu(null==e.category?null:e.category.name),t.xp6(2),t.Oqu(null==e.sequence?null:e.sequence.sequence_number),t.xp6(2),t.Oqu(null==e.brand?null:e.brand.name),t.xp6(2),t.Q6J("ngxPermissionsOnly",o.permission_edit),t.xp6(1),t.Q6J("ngxPermissionsOnly",o.permission_destroy)}}const Y=function(r,a,e){return{itemsPerPage:r,currentPage:a,totalItems:e}},B=[{path:"",data:{name:"productosMain"},children:[{path:"",component:(()=>{class r{constructor(e,o,i,c){this.s_products=e,this.s_standart=o,this.router=i,this.activeRoute=c,this.permission_create=["super-admin","products-admin.products.create"],this.permission_edit=["super-admin","products-admin.products.edit"],this.permission_destroy=["super-admin","products-admin.products.destroy"],this.pageCurrent=1,this.perPage=10,this.totalItem=0,this.formProducts=new n.cw({id:new n.NI("",[n.kI.required]),code:new n.NI("",[n.kI.required]),code_alt:new n.NI("",[n.kI.required]),name:new n.NI("",[n.kI.required]),description:new n.NI("",[n.kI.required]),prefix:new n.NI("",[n.kI.required]),category:new n.NI("",[n.kI.required]),sequence:new n.NI("",[n.kI.required]),brand:new n.NI("",[n.kI.required])})}ngOnInit(){const e=Number.parseInt(this.activeRoute.snapshot.queryParamMap.get("page"))||1,o=this.getQueryParams();o?this.nextPage(e,o):this.nextPage(e)}getQueryParams(){let e={};if(e=JSON.parse(JSON.stringify(this.activeRoute.snapshot.queryParamMap.params)),e.hasOwnProperty("page")&&delete e.page,"{}"!=e)try{const o=Object.keys(e);for(let i=0;i<o.length;i++)this.formProducts.controls[o[i]].setValue(e[o[i]]);return e}catch(o){return console.log(o),null}return null}nextPage(e=1,o=null){const i=o||this.findValidControls();this.s_standart.search2("products-admin/products",Object.assign(Object.assign({},i),{page:e})).subscribe(c=>{if(c&&c.hasOwnProperty("success")&&c.success){this.products=c.data,this.totalItem=this.products.total,this.perPage=this.products.per_page,this.pageCurrent=this.products.current_page,this.gotoTop();const L=Object.assign({page:this.pageCurrent},i);this.router.navigate([],{relativeTo:this.activeRoute,queryParams:L,replaceUrl:!0})}})}gotoTop(){document.getElementsByClassName("app-body")[0].scrollTop=0}findValidControls(){const e=[],o=this.formProducts.controls;for(const i in o)o[i].valid&&(e[i]=o[i].value);return e}goCreate(){this.router.navigate(["/admin-products/productos/create"])}destroyProduct(e){const o=this.products.data.findIndex(c=>c.id===e),i=Swal.mixin({customClass:{confirmButton:"btn btn-success mr-1",cancelButton:"btn btn-danger"},buttonsStyling:!1});i.fire({title:"Seguro que quieres eliminar esta Categor\xeda ?",text:this.products.data[o].name,icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!"}).then(c=>{c.isConfirmed?this.s_products.destroy(e).subscribe(()=>{-1!=o&&this.products.data.splice(o,1),i.fire("Eliminado!","Eliminado con \xe9xito.","success")}):c.dismiss===Swal.DismissReason.cancel&&i.fire("Cancelled","Tu acci\xf3n a sido cancelada :)","error")})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(b.s),t.Y36(w.X),t.Y36(u.F0),t.Y36(u.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-productos"]],decls:57,vars:11,consts:[[1,"mt-3","pb-3"],[1,"font-4xl","font-weight-bold"],[1,"card-header","d-flex","justify-content-between","align-items-center","sticky-top"],["color","primary","mat-raised-button","","type","button","class","btn btn-pill btn-warning",3,"click",4,"ngxPermissionsOnly"],[1,"card-body",3,"formGroup"],[1,"table","table-responsive","table-striped"],["scope","col"],["required","","formControlName","id",1,"form-control"],["formControlName","code","type","text",1,"form-control"],["formControlName","code_alt","type","text",1,"form-control"],["scope","col","colspan","2"],["formControlName","name","type","text",1,"form-control"],["formControlName","description","type","text",1,"form-control"],["formControlName","prefix","type","text",1,"form-control"],["formControlName","category","type","text",1,"form-control"],["formControlName","sequence","type","text",1,"form-control"],["formControlName","brand","type","text",1,"form-control"],["mat-raised-button","","color","accent","type","button",3,"click"],[4,"ngFor","ngForOf"],["maxSize","9","directionLinks","true","autoHide","true","responsive","true","previousLabel","Previous","nextLabel","Next","screenReaderPaginationLabel","Pagination","screenReaderPageLabel","page","screenReaderCurrentLabel","You're on page",3,"pageChange","pageBoundsCorrection"],["color","primary","mat-raised-button","","type","button",1,"btn","btn-pill","btn-warning",3,"click"],["colspan","2"],[1,"d-flex"],["routerLinkActive","router-link-active","class","mr-1 btn btn-sm btn-spotify","role","button",3,"routerLink",4,"ngxPermissionsOnly"],["class","btn btn-html5 btn-sm",3,"click",4,"ngxPermissionsOnly"],["routerLinkActive","router-link-active","role","button",1,"mr-1","btn","btn-sm","btn-spotify",3,"routerLink"],[1,"far","fa-edit"],[1,"btn","btn-html5","btn-sm",3,"click"],[1,"far","fa-trash-alt"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Productos"),t.qZA(),t.TgZ(3,"mat-card")(4,"div",2)(5,"div"),t._uU(6," Tabla de Productos "),t.qZA(),t.YNc(7,k,2,0,"button",3),t.qZA(),t.TgZ(8,"div",4)(9,"table",5)(10,"caption"),t._uU(11),t.qZA(),t.TgZ(12,"thead")(13,"tr")(14,"th",6),t._uU(15,"# "),t._UZ(16,"br")(17,"input",7),t.qZA(),t.TgZ(18,"th",6),t._uU(19,"C\xf3digo "),t._UZ(20,"br")(21,"input",8),t.qZA(),t.TgZ(22,"th",6),t._uU(23,"Alt. "),t._UZ(24,"br")(25,"input",9),t.qZA(),t.TgZ(26,"th",10),t._uU(27,"Nombre "),t._UZ(28,"br")(29,"input",11),t.qZA(),t.TgZ(30,"th",10),t._uU(31,"Descripci\xf3n "),t._UZ(32,"br")(33,"input",12),t.qZA(),t.TgZ(34,"th",6),t._uU(35,"Tipo "),t._UZ(36,"br")(37,"input",13),t.qZA(),t.TgZ(38,"th",6),t._uU(39,"Categor\xeda "),t._UZ(40,"br")(41,"input",14),t.qZA(),t.TgZ(42,"th",6),t._uU(43,"Secuencia "),t._UZ(44,"br")(45,"input",15),t.qZA(),t.TgZ(46,"th",6),t._uU(47,"Marca "),t._UZ(48,"br")(49,"input",16),t.qZA(),t.TgZ(50,"th",6)(51,"button",17),t.NdJ("click",function(){return o.nextPage()}),t._uU(52,"Buscar"),t.qZA()()()(),t.TgZ(53,"tbody"),t.YNc(54,F,22,11,"tr",18),t.ALo(55,"paginate"),t.qZA()(),t.TgZ(56,"pagination-controls",19),t.NdJ("pageChange",function(c){return o.nextPage(c)})("pageBoundsCorrection",function(c){return o.nextPage(c)}),t.qZA()()()()),2&e&&(t.xp6(7),t.Q6J("ngxPermissionsOnly",o.permission_create),t.xp6(1),t.Q6J("formGroup",o.formProducts),t.xp6(3),t.hij("Resultados de ",null==o.products?null:o.products.total," productos"),t.xp6(43),t.Q6J("ngForOf",t.xi3(55,4,null==o.products?null:o.products.data,t.kEZ(7,Y,o.perPage,o.pageCurrent,o.totalItem))))},dependencies:[l.sg,u.rH,u.Od,n.Fj,n.JJ,n.JL,n.Q7,n.sg,n.u,h.LS,g.lW,m.gE,_.a8,h._s],styles:[".table[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;color:inherit}"]}),r})(),data:{name:"productos"}},{path:"create",component:T,data:{isEdit:!1,permissions:{only:["super-admin","products-admin.products.create"]}},canActivate:[m.DD]},{path:"edit/:id",component:T,data:{isEdit:!0,permissions:{only:["super-admin","products-admin.products.edit"]}},canActivate:[m.DD]}]}];let V=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[u.Bz.forChild(B),u.Bz]}),r})(),M=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[l.ez,V,n.UX,h.JX,d.lN,f.c,C.LD,q.Ps,g.ot,m.VI,_.QW,d.lN,f.c]}),r})()}}]);